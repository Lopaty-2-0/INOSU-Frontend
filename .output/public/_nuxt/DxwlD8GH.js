import A from"./CLz_XDSv.js";import{e as S,z as R,r as l,j as T,k as E,l as I,w as U,m as L,o as P,a as s,b as d,u as p,t as k,h as C,v as G,d as B,q as z,_ as D}from"./J7-yQi-K.js";import{A as V}from"./Cizgxft2.js";import{N as j}from"./CR_H3JQR.js";import{U as $,G as q}from"./D2xg9N9j.js";import{u as H,_ as M}from"./CKKYFl9L.js";import{a as x}from"./C0hwI7pc.js";import{L as F}from"./Qpf0i4a6.js";import{u as Z}from"./PCjTfg1e.js";import"./BZ59wu3D.js";import"./CtpsiGFq.js";import"./C6MNyRTM.js";import"./DxXzBOxs.js";import"./C5S46NFB.js";const J={id:"users"},K={class:"content"},Q={class:"line"},W={class:"section-head"},X={class:"search"},Y={class:"buttons"},ee={class:"users"},te=S({__name:"remove",setup(se){const r=R().params.class;Z({title:"Panel | Odstranění uživatelů -  Třída: "+r,meta:[{name:"description",content:"Panel Settings User Information"}]});const v=l(!1),i=H(),a=l(null),_=l(0),b=l(0),c=l([]),g=l(!1),f=l(""),m=l([]),O=()=>{const o=f.value.split(" "),e=[];a.value&&(a.value.forEach(t=>{[t.name,t.surname,t.email,t.abbreviation||""].some(n=>{let y=!1;return o.forEach(N=>{y=n.toLowerCase().includes(N.toLowerCase())}),y})&&e.push(t)}),m.value=e)},h=()=>{g.value=!1,setTimeout(()=>{g.value=!0},10)},w=async()=>{!a.value||!c.value||(v.value=!0,await x("/user/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:{idUser:c.value.map(o=>o.id)},ignoreResponseError:!0,credentials:"include",onResponse({response:o}){switch(o._data.resCode.toString()){case"3010":i.addAlert({type:"error",title:"Odstranění uživatelů",message:"Nedostatečné oprávnění pro odstranění uživatelů."});break;case"3020":i.addAlert({type:"warning",title:"Odstranění uživatelů",message:"Žádný uživatel nebyl vybrán."});break;case"3030":i.addAlert({type:"warning",title:"Odstranění uživatelů",message:"Nemůžete odstranit sám sebe."});break;case"3040":i.addAlert({type:"warning",title:"Odstranění uživatelů",message:"Nemůžete odstranit sám sebe."});break;case"3051":i.addAlert({type:"success",title:"Odstranění uživatelů",message:"Uživatelé byli úspěšně odstraněni."}),a.value&&(a.value=a.value.filter(t=>!c.value.some(u=>u.id===t.id)),m.value=[...a.value],h());break;default:i.addAlert({type:"error",title:"Odstranění uživatelů",message:"Nastala neznámá chyba."});break}},onRequestError(){i.addAlert({type:"error",title:"Odstranění uživatelů",message:"Nastala neznámá chyba."})}}).finally(()=>{v.value=!1}))};return T(async()=>{await x(r!=="undefined"?`/user_class/get/users?idClass=${encodeURIComponent(r)}`:"/user/get/noClass",{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,onResponse({response:o}){var t,u;const e=((u=(t=o._data)==null?void 0:t.data)==null?void 0:u.users)||[];a.value=e,m.value=[...e]}})}),(o,e)=>{const t=A,u=L;return P(),E(u,{name:"panel",loading:!a.value},I({header:U(()=>[d(j,{links:[{name:"Uživatelé",path:"/panel/users"},{name:"student",path:"/panel/users/student"},{name:"Třída: "+p(r),path:"/panel/users/student/"+p(r)},{name:"Odstranění",path:"/panel/users/student/"+p(r)+"/remove"}]},null,8,["links"])]),_:2},[a.value?{name:"content",fn:U(()=>[s("div",J,[s("div",K,[d(V,{class:"action-bar",description:"Správa uživatelů",active:2,texts:["Přidat","Upravit","Odebrat"],icons:["material-symbols:add-rounded","material-symbols:edit-rounded","material-symbols:delete-rounded"],"navigate-to":["/panel/users/add",`/panel/users/student/${p(r)}/edit`,`/panel/users/student/${p(r)}/remove`]},null,8,["navigate-to"]),s("div",Q,[s("div",W,[s("h3",null," Uživatelé: "+k(c.value.length)+" / "+k(m.value.length),1),e[4]||(e[4]=s("p",null,"Lorem ipsum dolor sit amet, consectetur adipisicing elit.",-1))]),s("div",X,[C(s("input",{type:"text",name:"searchInput",placeholder:"Hledat uživatele",onInput:O,"onUpdate:modelValue":e[0]||(e[0]=n=>f.value=n)},null,544),[[G,f.value]]),d(t,{class:"icon",name:"material-symbols:search-rounded"})])]),s("div",Y,[s("button",{class:"remove",onClick:w},[e[5]||(e[5]=B(" Odstranit ")),C(d(F,{size:"5px",color:"var(--actionBar-actions-remove-color)"},null,512),[[z,v.value]])]),s("button",{class:"reset",onClick:h}," Zrušit vše ")]),s("div",ee,[d($,{users:m.value,"users-per-page":12,action:"remove","active-page":b.value,reset:g.value,"onGet:numberOfPages":e[1]||(e[1]=n=>_.value=n),"onGet:selectedUsers":e[2]||(e[2]=n=>c.value=n)},null,8,["users","active-page","reset"]),d(q,{class:"users-navigation","number-of-pages":_.value,"onGet:activePage":e[3]||(e[3]=n=>b.value=n)},null,8,["number-of-pages"])])]),d(M)])]),key:"0"}:void 0]),1032,["loading"])}}}),be=D(te,[["__scopeId","data-v-131379a5"]]);export{be as default};
//# sourceMappingURL=DxwlD8GH.js.map
