import{e as T,z as F,r as d,j as D,k as E,w as n,m as S,E as B,o as h,a as s,b as r,d as u,h as p,q as v,c as I,u as m,_ as Z}from"./J7-yQi-K.js";import{E as V}from"./D1UCuGGY.js";import{u as q,_ as H}from"./CKKYFl9L.js";import{N as J}from"./CR_H3JQR.js";import{a as b}from"./C0hwI7pc.js";import{E as O,a as $,b as M,c as G}from"./BZGO30OP.js";import{E as K}from"./CX6KQKNR.js";import{E as Q}from"./BGlMjmGi.js";import{E as W}from"./D1PQAQT1.js";import{u as X}from"./PCjTfg1e.js";import"./Qpf0i4a6.js";import"./CLz_XDSv.js";import"./BZ59wu3D.js";import"./CtpsiGFq.js";import"./C6MNyRTM.js";import"./DxXzBOxs.js";const Y={id:"settings"},ee={class:"content"},ae={class:"line page-section"},se={class:"section-head"},te={class:"update"},le={class:"line page-section"},oe={class:"line page-section"},ie={class:"section-head"},re={class:"update"},ne={class:"line page-section"},ue={class:"section-head"},de={class:"update"},pe={class:"line page-section"},ve={class:"section-head"},me={class:"update"},ce={class:"line page-section"},fe={class:"section-head"},be={class:"update"},_e={class:"line page-section"},ge={class:"section-head"},ke={class:"update"},he={key:1,class:"error"},ye=T({__name:"[id]",setup(Ue){const y=F(),w=B(),c=y.params.id,f=y.params.role;X({title:"Panel | Upravení uživatele - "+c,meta:[{name:"description",content:"Panel Settings User Information"}]});const o=q(),_=d(!1),i=d(!1),g=d(void 0),k=d(void 0),l=d({loaded:!1,profilePicture:"",name:"",surname:"",email:"",password:"",abbreviation:"",role:"",classes:[]}),e=d({profilePicture:void 0,name:void 0,surname:void 0,email:void 0,password:void 0,abbreviation:void 0,role:void 0,classes:void 0}),R=t=>{e.value.name=t.name,e.value.surname=t.surname},j=t=>{e.value.email=t.email},A=t=>{e.value.password=t.password},z=t=>{e.value.abbreviation=t.abbreviation},C=t=>{e.value.role=t.role},N=t=>{e.value.classes=t.classes},L=t=>{e.value.profilePicture=t.profilePicture},U=()=>{e.value={profilePicture:void 0,name:void 0,surname:void 0,email:void 0,password:void 0,abbreviation:void 0,role:void 0,classes:void 0},i.value=!0,setTimeout(()=>{i.value=!1},100)},x=async()=>{_.value=!0;const t=new FormData;e.value.profilePicture&&t.append("profilePicture",e.value.profilePicture),e.value.name&&t.append("name",e.value.name),e.value.surname&&t.append("surname",e.value.surname),e.value.email&&t.append("email",e.value.email),e.value.abbreviation&&t.append("abbreviation",e.value.abbreviation),e.value.role&&t.append("role",e.value.role),e.value.classes&&t.append("idClass",JSON.stringify(e.value.classes)),t.append("idUser",c),await b("/user/update",{method:"PUT",body:t,credentials:"include",ignoreResponseError:!0,async onResponse({response:a}){switch(a._data.resCode.toString()){case"2040":o.addAlert({type:"error",title:"Úprava uživatele",message:"Nemáte oprávnění k této akci."});break;case"2050":o.addAlert({type:"warning",title:"Úprava uživatele",message:"Nic nebylo zadáno ke změně."});break;case"2060":o.addAlert({type:"error",title:"Úprava uživatele",message:"Špatné ID uživatele."});break;case"2070":o.addAlert({type:"error",title:"Úprava uživatele",message:"Zkratka je již používána."});break;case"2080":o.addAlert({type:"error",title:"Úprava uživatele",message:"Zkratka je příliš dlouhá."});break;case"2090":o.addAlert({type:"error",title:"Úprava uživatele",message:"Špatný formát e-mailu."});break;case"2100":o.addAlert({type:"error",title:"Úprava uživatele",message:"E-mail je již používán."});break;case"2110":o.addAlert({type:"error",title:"Úprava uživatele",message:"E-mail je příliš dlouhý."});break;case"2120":o.addAlert({type:"error",title:"Úprava uživatele",message:"Špatný formát souboru."});break;case"2131":o.addAlert({type:"success",title:"Úprava uživatele",message:"Uživatel byl úspěšně upraven."}),e.value.name&&(l.value.name=e.value.name),e.value.surname&&(l.value.surname=e.value.surname),e.value.email&&(l.value.email=e.value.email),e.value.abbreviation&&(l.value.abbreviation=e.value.abbreviation),e.value.role&&(l.value.role=e.value.role),e.value.classes&&(l.value.classes=e.value.classes),e.value.profilePicture&&(l.value.profilePicture=URL.createObjectURL(e.value.profilePicture)),U();break;default:o.addAlert({type:"error",title:"Úprava uživatele",message:"Nastala neznámá chyba."});break}},async onRequestError(){o.addAlert({type:"error",title:"Úprava uživatele",message:"Nastala neznámá chyba."})}}).finally(()=>{_.value=!1})};return D(async()=>{await b("/user/get/roles",{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,onResponse({response:t}){const a=t._data.data.roles;g.value=a||[]}}),await b("/class/get",{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,onResponse({response:t}){const a=t._data.data.classes;k.value=a||[]}}),await b(`/user/get/id?id=${encodeURIComponent(c)}`,{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,async onResponse({response:t}){const a=t._data.data.user;if(a)l.value.name=a.name,l.value.surname=a.surname,l.value.email=a.email,l.value.password="",l.value.abbreviation=a.abbreviation||"",l.value.role=a.role,l.value.classes=a.idClass,l.value.profilePicture="http://89.203.248.163/uploads/profilePictures/"+a.profilePicture;else{await w.push(`/panel/users/${f}/edit`);return}l.value.loaded=!0}})}),(t,a)=>{const P=S;return h(),E(P,{name:"panel",loading:!g.value||!k.value||!l.value.loaded},{header:n(()=>[r(J,{links:[{name:"Uživatelé",path:"/panel/users"},{name:m(f),path:"/panel/users/"+m(f)},{name:"Upravení",path:"/panel/users/"+m(f)+"/edit"},{name:m(c),path:"/panel/users/"+m(f)+"/edit/"+m(c)}]},null,8,["links"])]),content:n(()=>[s("div",Y,[s("div",ee,[s("div",ae,[r(W,{class:"page-section","old-profile-picture":l.value.profilePicture,onUpdate:L,reset:i.value},{default:n(()=>[s("div",se,[s("h3",null,[a[0]||(a[0]=u(" Profilová fotka ")),p(s("span",te,"(aktualizováno)",512),[[v,e.value.profilePicture]])]),a[1]||(a[1]=s("p",null,"Změňte svůj profilový obrázek",-1))])]),_:1},8,["old-profile-picture","reset"])]),s("div",le,[r(O,{"old-full-name":{name:l.value.name,surname:l.value.surname},reset:i.value,onUpdate:R},{default:n(()=>a[2]||(a[2]=[s("div",{class:"section-head"},[s("h3",null,"Jméno a příjmení"),s("p",null,"Změňte své jméno a příjmení")],-1)])),_:1},8,["old-full-name","reset"])]),s("div",oe,[r($,{"old-email":l.value.email,reset:i.value,onUpdate:j},{default:n(()=>[s("div",ie,[s("h3",null,[a[3]||(a[3]=u("E-mail ")),p(s("span",re,"(aktualizováno)",512),[[v,e.value.email]])]),a[4]||(a[4]=s("p",null,"Lorem ipsum dolor sit amet, consectetur adipisicing elit.",-1))])]),_:1},8,["old-email","reset"])]),s("div",ne,[r(K,{type:"new",reset:i.value,onUpdate:A},{default:n(()=>[s("div",ue,[s("h3",null,[a[5]||(a[5]=u("Heslo k účtu ")),p(s("span",de,"(aktualizováno)",512),[[v,e.value.password]])]),a[6]||(a[6]=s("p",null,"Lorem ipsum dolor sit amet, consectetur adipisicing elit.",-1))])]),_:1},8,["reset"])]),s("div",pe,[r(M,{roles:g.value||[],"old-role":l.value.role,reset:i.value,onUpdate:C},{default:n(()=>[s("div",ve,[s("h3",null,[a[7]||(a[7]=u("Role ")),p(s("span",me,"(aktualizováno)",512),[[v,e.value.role]])]),a[8]||(a[8]=s("p",null,"Lorem ipsum dolor sit amet, consectetur adipisicing elit.",-1))])]),_:1},8,["roles","old-role","reset"])]),s("div",ce,[r(G,{"full-name":{name:e.value.name?e.value.name:l.value.name,surname:e.value.surname?e.value.surname:l.value.surname},"old-abbreviation":l.value.abbreviation,reset:i.value,onUpdate:z},{default:n(()=>[s("div",fe,[s("h3",null,[a[9]||(a[9]=u("Přezdívka ")),p(s("span",be,"(aktualizováno)",512),[[v,e.value.abbreviation]])]),a[10]||(a[10]=s("p",null,"Lorem ipsum dolor sit amet, consectetur adipisicing elit.",-1))])]),_:1},8,["full-name","old-abbreviation","reset"])]),s("div",_e,[s("div",ge,[s("h3",null,[a[11]||(a[11]=u("Třída ")),p(s("span",ke,"(aktualizováno)",512),[[v,e.value.classes]])]),a[12]||(a[12]=s("p",null,"Lorem ipsum dolor sit amet, consectetur adipisicing elit.",-1))]),(e.value.role?e.value.role==="student":l.value.role==="student")?(h(),E(Q,{key:0,"old-class-ids":l.value.classes,classes:k.value||[],reset:i.value,onUpdate:N},null,8,["old-class-ids","classes","reset"])):(h(),I("p",he,a[13]||(a[13]=[u(" Třídy můžete vybírat pouze pokud role uživatele je "),s("strong",null,"student",-1),u(". ")])))]),r(V,{"is-loading":_.value,"reset-function":U,"submit-function":x},null,8,["is-loading"])]),r(H)])]),_:1},8,["loading"])}}}),Ie=Z(ye,[["__scopeId","data-v-1431fc93"]]);export{Ie as default};
//# sourceMappingURL=fzsy56Kf.js.map
