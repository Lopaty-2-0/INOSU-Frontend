import E from"./B02K3sSP.js";import{e as F,r as u,A as P,c as v,o as m,B as M,a as s,x as b,b as y,d as k,t as w,g as V,h as B,v as R,_ as A}from"./kDuM05C4.js";import{u as L}from"./Dp9DwRaU.js";const S={class:"section"},D={class:"items"},$={class:"section"},q={class:"content image"},K=["src"],O={key:0},G={key:1},H={class:"section url"},J={class:"content"},Q={class:"line"},W={key:0,class:"input-error"},X=F({__name:"ProfilePicture",props:{oldProfilePicture:{type:String,required:!0},reset:{type:Boolean,default:!1}},emits:["update"],setup(z,{emit:x}){const c=z,j=x,r=u(c.oldProfilePicture),f=u(null),p=u(null),l=u(""),i=u({file:"",url:""}),U=()=>{f.value&&f.value.click()},d=()=>{i.value={file:"",url:""}},g=(o,e)=>{switch(e){case"file":i.value.file=o;break;case"url":i.value.url=o;break}l.value="",r.value=c.oldProfilePicture},_=async o=>{if(!["image/jpeg","image/png","image/gif"].includes(o.type))throw{customMessage:"Nepodporovaný typ souboru. Povoleny jsou pouze jpg, png nebo gif."};return new Promise((t,a)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=()=>a("Nepodařilo se přečíst soubor."),n.readAsDataURL(o)})},N=async o=>{const e=await $fetch(o,{responseType:"blob"}),t=o.split("/").pop()||"image.png",a=e.type;if(!["image/jpeg","image/png","image/gif"].includes(a))throw{customMessage:"Nepodporovaný typ souboru. Povoleny jsou pouze jpg, png nebo gif."};return new File([e],t,{type:a})},T=async o=>{var a;d();const t=(a=o.target.files)==null?void 0:a[0];if(t){if(t.size>2097152){g("Obrázek je příliš velký, nahrajte prosím jiný.","file");return}try{p.value=t,r.value=await _(t),l.value=""}catch(n){g(n.customMessage||"Nepodařilo se přečíst soubor.","file")}}},h=async o=>{d();try{const e=await N(o);r.value=await _(e),p.value=e}catch(e){g(e.customMessage||"Nepodařilo se načíst obrázek z URL adresy.","url")}},I=async()=>{if(!l.value){d(),r.value=c.oldProfilePicture;return}await h(l.value)},C=async()=>{try{l.value=await navigator.clipboard.readText(),await h(l.value)}catch{L().addAlert({type:"warning",title:"Vložení URL",message:"Váš prohlížeč nepodporuje vkládání."})}};return P(()=>r.value,()=>{j("update",{profilePicture:c.oldProfilePicture!==r.value?p.value:void 0})}),P(()=>c.reset,o=>{o&&(d(),r.value=c.oldProfilePicture,p.value=null,l.value="")}),(o,e)=>{const t=E;return m(),v("div",S,[M(o.$slots,"default",{},void 0,!0),s("div",D,[s("div",$,[s("div",q,[s("img",{loading:"lazy",src:r.value,alt:"Profile photo"},null,8,K),s("div",{class:b(["content upload-file",{error:i.value.file}]),onClick:U},[i.value.file?(m(),v("p",O,[y(t,{class:"icon",size:"60px",name:"material-symbols:error-rounded"}),k(" "+w(i.value.file),1)])):(m(),v("p",G,[y(t,{class:"icon",size:"60px",name:"material-symbols:cloud-upload"}),e[2]||(e[2]=k(" Klikni pro nahrání obrázku z počítače "))])),s("input",{type:"file",size:"2097152",placeholder:"Profile image file",ref_key:"fileInput",ref:f,onChange:e[0]||(e[0]=a=>T(a)),accept:".png,.jpg,.jpeg,.gif"},null,544)],2)])]),s("div",H,[s("div",J,[e[3]||(e[3]=s("label",{for:"image"},"URL obrázku",-1)),s("div",Q,[B(s("input",{class:b({error:i.value.url}),type:"text",id:"image",name:"image",placeholder:"https://example.image/image.png","onUpdate:modelValue":e[1]||(e[1]=a=>l.value=a),onChange:I},null,34),[[R,l.value]]),s("div",{class:"icon-div",onClick:C},[y(t,{class:"icon",size:"16px",name:"material-symbols:content-paste"})])]),i.value.url?(m(),v("p",W,w(i.value.url),1)):V("",!0)])])])])}}}),oe=A(X,[["__scopeId","data-v-16c11dc9"]]);export{oe as E};
//# sourceMappingURL=PmcGXoYP.js.map
