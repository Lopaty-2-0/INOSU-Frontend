import N from"./B02K3sSP.js";import{e as S,z as R,r as o,j as I,k as P,l as G,w as U,m as T,o as z,a,b as d,u as p,t as k,h as x,v as B,d as E,q as L,_ as V}from"./kDuM05C4.js";import{N as $}from"./D4lJweNB.js";import{a as O}from"./CqzinUfa.js";import{A as j}from"./BXO4Rf_k.js";import{U as D,G as q}from"./8F1AEd8e.js";import{u as H,_ as M}from"./Dp9DwRaU.js";import{L as F}from"./gZJpIgEh.js";import{u as Z}from"./1qNVQyrd.js";import"./Fcahhvwm.js";import"./D_aNzk6r.js";import"./DKN3VG1g.js";import"./Dy3G499-.js";import"./C5S46NFB.js";const J={id:"users"},K={class:"content"},Q={class:"line"},W={class:"section-head"},X={class:"search"},Y={class:"buttons"},ee={class:"users"},te=S({__name:"remove",setup(ae){const l=R().params.role;Z({title:"Panel | Odstranění uživatelů - "+l,meta:[{name:"description",content:"Panel Settings User Information"}]});const m=o(!1),i=H(),s=o(null),_=o(0),b=o(0),c=o([]),g=o(!1),f=o(""),v=o([]),w=()=>{const n=f.value.split(" "),e=[];s.value&&(s.value.forEach(t=>{[t.name,t.surname,t.email,t.abbreviation||""].some(r=>{let y=!1;return n.forEach(A=>{y=r.toLowerCase().includes(A.toLowerCase())}),y})&&e.push(t)}),v.value=e)},h=()=>{g.value=!1,setTimeout(()=>{g.value=!0},10)},C=async()=>{!s.value||!c.value||(m.value=!0,await O("/user/delete",{method:"delete",headers:{"Content-Type":"application/json"},body:{idUser:c.value.map(n=>n.id)},ignoreResponseError:!0,credentials:"include",onResponse({response:n}){switch(n._data.resCode.toString()){case"3010":i.addAlert({type:"error",title:"Odstranění uživatelů",message:"Nedostatečné oprávnění pro odstranění uživatelů."});break;case"3020":i.addAlert({type:"warning",title:"Odstranění uživatelů",message:"Žádný uživatel nebyl vybrán."});break;case"3030":i.addAlert({type:"warning",title:"Odstranění uživatelů",message:"Nemůžete odstranit sám sebe."});break;case"3040":i.addAlert({type:"warning",title:"Odstranění uživatelů",message:"Žádný uživatel nebyl odstraněn."});break;case"3051":i.addAlert({type:"success",title:"Odstranění uživatelů",message:`Uživatelé byli úspěšně odstraněni. (${n._data.data.deletedIds.length}/${c.value.length})`}),s.value&&(s.value=s.value.filter(t=>!c.value.some(u=>u.id===t.id)),v.value=[...s.value],h());break;default:i.addAlert({type:"error",title:"Odstranění uživatelů",message:"Nastala neznámá chyba."});break}},onRequestError(){i.addAlert({type:"error",title:"Odstranění uživatelů",message:"Nastala neznámá chyba."})}}).finally(()=>{m.value=!1}))};return I(async()=>{await O(`/user/get/role?role=${encodeURIComponent(l)}`,{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,onResponse({response:n}){var t,u;const e=((u=(t=n._data)==null?void 0:t.data)==null?void 0:u.users)||[];s.value=e,v.value=[...e]}})}),(n,e)=>{const t=N,u=T;return z(),P(u,{name:"panel",loading:!s.value},G({header:U(()=>[d($,{links:[{name:"Uživatelé",path:"/panel/users"},{name:p(l),path:"/panel/users/"+p(l)},{name:"Odstranění",path:"/panel/users/"+p(l)+"/remove"}]},null,8,["links"])]),_:2},[s.value?{name:"content",fn:U(()=>[a("div",J,[a("div",K,[d(j,{class:"action-bar",description:"Správa uživatelů",active:2,texts:["Přidat","Upravit","Odebrat"],icons:["material-symbols:add-rounded","material-symbols:edit-rounded","material-symbols:delete-rounded"],"navigate-to":["/panel/users/add",`/panel/users/${p(l)}/edit`,`/panel/users/${p(l)}/remove`]},null,8,["navigate-to"]),a("div",Q,[a("div",W,[a("h3",null," Uživatelé: "+k(c.value.length)+" / "+k(v.value.length),1),e[4]||(e[4]=a("p",null,"Vyberte uživatele, které chcete odstranit, nebo použijte vyhledávání pro zúžení výběru.",-1))]),a("div",X,[x(a("input",{type:"text",name:"searchInput",placeholder:"Hledat uživatele",onInput:w,"onUpdate:modelValue":e[0]||(e[0]=r=>f.value=r)},null,544),[[B,f.value]]),d(t,{class:"icon",name:"material-symbols:search-rounded"})])]),a("div",Y,[a("button",{class:"remove",onClick:C},[e[5]||(e[5]=E(" Odstranit ")),x(d(F,{size:"5px",color:"var(--actionBar-actions-remove-color)"},null,512),[[L,m.value]])]),a("button",{class:"reset",onClick:h}," Zrušit vše ")]),a("div",ee,[d(D,{users:v.value,"users-per-page":12,action:"remove","active-page":b.value,reset:g.value,"onGet:numberOfPages":e[1]||(e[1]=r=>_.value=r),"onGet:selectedUsers":e[2]||(e[2]=r=>c.value=r)},null,8,["users","active-page","reset"]),d(q,{class:"users-navigation","number-of-pages":_.value,"onGet:activePage":e[3]||(e[3]=r=>b.value=r)},null,8,["number-of-pages"])])]),d(M)])]),key:"0"}:void 0]),1032,["loading"])}}}),be=V(te,[["__scopeId","data-v-8d53afbf"]]);export{be as default};
//# sourceMappingURL=CsxiWtPL.js.map
