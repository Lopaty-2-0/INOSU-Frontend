import I from"./CLz_XDSv.js";import{e as R,z as T,r as d,j as V,E as C,k as E,l as Y,w as f,m as S,o as b,a as e,b as u,t as l,u as v,c as w,d as D,h as P,q,g as B,_ as L}from"./J7-yQi-K.js";import{N as Z}from"./CR_H3JQR.js";import{a as z}from"./C0hwI7pc.js";import{m as x}from"./qbsqZPAI.js";import{u as G,_ as K}from"./CKKYFl9L.js";import{u as J}from"./PCjTfg1e.js";import{E as O}from"./6S0avNnf.js";import{E as Q}from"./D1UCuGGY.js";import"./BZ59wu3D.js";import"./Qpf0i4a6.js";import"./CtpsiGFq.js";import"./C6MNyRTM.js";import"./DxXzBOxs.js";const W={id:"task"},X={class:"content"},ee={class:"line page-section"},ae={class:"section-head"},te={class:"profile"},oe={class:"data"},se=["src"],le={class:"line page-section"},ne={class:"section-head"},ie={class:"line file"},re=["href"],de=["href"],ue={class:"line page-section"},ce={class:"section-head"},ve={key:0,class:"line file"},pe=["href"],me=["href"],_e={key:1},ke={class:"line page-section review"},he={class:"section-head"},fe={class:"update"},be={class:"column"},ye=["href"],ge=R({__name:"[userId]",setup(we){const $=T(),H=C(),p=$.params.taskId,m=$.params.userId;J({title:"Panel | Vypracování úkolu: "+p+" - uživatelem: "+m,meta:[{name:"description",content:"Panel Homepage"}]});const o=G(),a=d(void 0),n=d(void 0),_=d(void 0),i=d(void 0),y=d(!1),h=d(void 0),N=d(void 0),g=d(!1),j=()=>{a.value&&(a.value.review=N.value),i.value=void 0},F=()=>{h.value=void 0,i.value=void 0,a.value&&(a.value.review=void 0),g.value=!0,setTimeout(()=>{g.value=!1},100)},M=async()=>{y.value=!0;const s=new FormData;s.append("idTask",p),s.append("idUser",m),s.append("review",i.value||""),await z("/user_task/update",{method:"put",body:s,credentials:"include",ignoreResponseError:!0,async onResponse({response:t}){var c,k,A;switch((c=t._data.resCode)==null?void 0:c.toString()){case"38010":o.addAlert({type:"error",title:"Hodnocení",message:"Nebyl zadán id úkolu."});break;case"38020":o.addAlert({type:"error",title:"Hodnocení",message:"Uživatel neexistuje."});break;case"38030":o.addAlert({type:"error",title:"Hodnocení",message:"Úkol neexistuje."});break;case"38040":o.addAlert({type:"error",title:"Hodnocení",message:"Záznam user_task neexistuje."});break;case"38050":o.addAlert({type:"error",title:"Hodnocení",message:"Špatný formát souboru (review)."});break;case"38060":o.addAlert({type:"error",title:"Hodnocení",message:"Nelze provést tuto akci (review lze nahrát jen u schváleného úkolu)."});break;case"38070":o.addAlert({type:"error",title:"Hodnocení",message:"Název souboru (review) je příliš dlouhý."});break;case"38080":o.addAlert({type:"error",title:"Vypracování",message:"Špatný formát souboru (elaboration)."});break;case"38090":o.addAlert({type:"error",title:"Vypracování",message:"Název souboru (elaboration) je příliš dlouhý."});break;case"38100":o.addAlert({type:"error",title:"Hodnocení",message:"Nemáte oprávnění."});break;case"38111":o.addAlert({type:"success",title:"Hodnocení",message:"Hodnocení bylo úspěšně aktualizováno."}),a.value&&(a.value.review=((k=i.value)==null?void 0:k.name)||void 0,h.value=((A=i.value)==null?void 0:A.name)||void 0),i.value=void 0;break;default:o.addAlert({type:"error",title:"Hodnocení",message:"Nastala neznámá chyba."});break}},onRequestError(){o.addAlert({type:"error",title:"Hodnocení",message:"Nastala chyba při odesílání požadavku."})}}).finally(()=>{y.value=!1})},U=s=>{i.value=s};return V(async()=>{try{await z(`/user_task/get/idUser/idTask?idTask=${p}&idUser=${m}`,{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",async onResponse({response:s}){var k;const t=s._data.data.task,r=s._data.data.task.elaborator,c=s._data.data.task.guarantor;if(!t||!r||!c){await H.push("/panel/tasks/admin");return}a.value={...t,id:t.idTask,review:t.review},N.value=(k=a.value)==null?void 0:k.review,n.value=r,_.value=c}})}catch{await H.push("/panel/tasks/admin");return}}),(s,t)=>{const r=I,c=S;return b(),E(c,{name:"panel",loading:!a.value||!n.value||!_.value},Y({header:f(()=>[u(Z,{links:[{name:"Úkoly",path:"/panel/tasks/admin"},{name:`Úkol: ${v(p)}`,path:`/panel/tasks/admin/${v(p)}`},{name:`Uživatel: ${v(m)}`,path:`/panel/tasks/admin/${v(p)}/${v(m)}`}]},null,8,["links"])]),_:2},[a.value&&n.value&&_.value?{name:"content",fn:f(()=>[e("div",W,[e("div",X,[e("div",ee,[e("div",ae,[e("h3",null,l(a.value.name),1),e("p",null,"Úkol ID: "+l(a.value.id),1),e("p",null,"Garant: "+l(_.value.name)+" "+l(_.value.surname),1),e("p",null,"Začátek: "+l(v(x)(a.value.startDate).format("DD.MM. YYYY HH:MM")),1),e("p",null,"Konec: "+l(v(x)(a.value.endDate).format("DD.MM. YYYY HH:MM")),1),e("p",null,"Nutné potvrzení: "+l(a.value.approve?"Ano":"Ne"),1),e("div",te,[t[0]||(t[0]=e("p",null,"Vypracovává:",-1)),e("div",oe,[e("img",{src:"http://89.203.248.163/uploads/profilePictures/"+n.value.profilePicture,alt:"User profile photo",loading:"lazy"},null,8,se),e("span",null,l(n.value.name)+" "+l(n.value.surname),1)])])])]),e("div",le,[e("div",ne,[t[1]||(t[1]=e("h3",null,"Materiály",-1)),e("div",ie,[e("a",{href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${a.value.task}`,class:"link",download:"",target:"_blank"},l(a.value.task),9,re),e("a",{class:"icon-div",href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${a.value.task}`,download:"",target:"_blank"},[u(r,{class:"icon",name:"material-symbols:download-2-rounded"})],8,de)])])]),e("div",ue,[e("div",ce,[t[3]||(t[3]=e("h3",null,"Vypracování",-1)),a.value.elaboration?(b(),w("div",ve,[e("a",{href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${n.value.id}/elaboration/${a.value.elaboration}`,class:"link",download:"",target:"_blank"},l(a.value.elaboration),9,pe),e("a",{class:"icon-div",href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${n.value.id}/elaboration/${a.value.elaboration}`,download:"",target:"_blank"},[u(r,{class:"icon",name:"material-symbols:download-2-rounded"})],8,me)])):(b(),w("p",_e,t[2]||(t[2]=[e("span",{class:"error"},"Uživatel ještě nevypracoval tento úkol.",-1)])))])]),e("div",ke,[u(O,{reset:g.value,"old-task-file":a.value.review,onUpdate:U},{default:f(()=>[e("div",he,[e("h3",null,[t[4]||(t[4]=D("Hodnocení ")),P(e("span",fe,"(aktualizováno)",512),[[q,i.value!==void 0]])]),t[5]||(t[5]=e("p",null,"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ab aliquam consequatur mollitia officiis placeat!",-1))])]),_:1},8,["reset","old-task-file"]),e("div",be,[e("button",{class:"icon-div",onClick:F},[u(r,{class:"icon",name:"material-symbols:delete"})]),h.value||a.value.review?(b(),w("a",{key:0,class:"icon-div",href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${n.value.id}/review/${h.value||a.value.review}`,download:"",target:"_blank"},[u(r,{class:"icon",name:"material-symbols:download-2-rounded"})],8,ye)):B("",!0)])]),u(Q,{"is-loading":y.value,"reset-function":j,"submit-function":M},{default:f(()=>t[6]||(t[6]=[D(" Pole označená * jsou povinná ")])),_:1},8,["is-loading"])])]),u(K)]),key:"0"}:void 0]),1032,["loading"])}}}),Ve=L(ge,[["__scopeId","data-v-bbe82751"]]);export{Ve as default};
//# sourceMappingURL=DoBIdfRC.js.map
