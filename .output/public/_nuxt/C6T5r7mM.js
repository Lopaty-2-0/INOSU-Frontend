import I from"./D0YqDxnM.js";import{e as U,z as C,r as d,j as R,E as V,k as E,l as P,w as f,m as Y,o as b,a as e,b as u,t as n,u as v,c as w,d as A,h as S,q as B,g as Z,_ as q}from"./CUZeRvXC.js";import{N as L}from"./DCknVipl.js";import{a as z}from"./CkL4TXxs.js";import{m as x}from"./qbsqZPAI.js";import{u as O,_ as G}from"./Z5wW8-57.js";import{u as K}from"./Db-zqWpw.js";import{E as X}from"./BV4m3uNk.js";import{E as J}from"./CYogHZGX.js";import"./BggygjHh.js";import"./DaNuMFcU.js";import"./CnmWWN_2.js";import"./Bz2aGY34.js";import"./DU8lQhTt.js";const Q={id:"task"},W={class:"content"},ee={class:"line page-section"},ae={class:"section-head"},te={class:"profile"},oe={class:"data"},se=["src"],ne={class:"line page-section"},le={class:"section-head"},re={class:"line file"},ie=["href"],de=["href"],ue={class:"line page-section"},ce={class:"section-head"},ve={key:0,class:"line file"},pe=["href"],me=["href"],_e={key:1},ke={class:"line page-section review"},he={class:"section-head"},fe={class:"update"},be={class:"column"},ye=["href"],ge=U({__name:"[userId]",setup(we){const H=C(),$=V(),p=H.params.taskId,m=H.params.userId;K({title:"Panel | Vypracování úkolu: "+p+" - uživatelem: "+m,meta:[{name:"description",content:"Panel Homepage"}]});const o=O(),a=d(void 0),l=d(void 0),_=d(void 0),r=d(void 0),y=d(!1),h=d(void 0),N=d(void 0),g=d(!1),F=()=>{a.value&&(a.value.review=N.value),r.value=void 0},M=()=>{h.value=void 0,r.value=void 0,a.value&&(a.value.review=void 0),g.value=!0,setTimeout(()=>{g.value=!1},100)},T=async()=>{y.value=!0;const s=new FormData;s.append("idTask",p),s.append("idUser",m),s.append("review",r.value||""),await z("/user_task/update",{method:"put",body:s,credentials:"include",ignoreResponseError:!0,async onResponse({response:t}){var c,k,D;switch((c=t._data.resCode)==null?void 0:c.toString()){case"38010":o.addAlert({type:"error",title:"Hodnocení",message:"Nebyl zadán id úkolu."});break;case"38020":o.addAlert({type:"error",title:"Hodnocení",message:"Uživatel neexistuje."});break;case"38030":o.addAlert({type:"error",title:"Hodnocení",message:"Úkol neexistuje."});break;case"38040":o.addAlert({type:"error",title:"Hodnocení",message:"Záznam user_task neexistuje."});break;case"38050":o.addAlert({type:"error",title:"Hodnocení",message:"Špatný formát souboru (review)."});break;case"38060":o.addAlert({type:"error",title:"Hodnocení",message:"Nelze provést tuto akci (review lze nahrát jen u schváleného úkolu)."});break;case"38070":o.addAlert({type:"error",title:"Hodnocení",message:"Název souboru (review) je příliš dlouhý."});break;case"38080":o.addAlert({type:"error",title:"Vypracování",message:"Špatný formát souboru (elaboration)."});break;case"38090":o.addAlert({type:"error",title:"Vypracování",message:"Název souboru (elaboration) je příliš dlouhý."});break;case"38100":o.addAlert({type:"error",title:"Hodnocení",message:"Nemáte oprávnění."});break;case"38111":o.addAlert({type:"success",title:"Hodnocení",message:"Hodnocení bylo úspěšně aktualizováno."}),a.value&&(a.value.review=((k=r.value)==null?void 0:k.name)||void 0,h.value=((D=r.value)==null?void 0:D.name)||void 0),r.value=void 0;break;default:o.addAlert({type:"error",title:"Hodnocení",message:"Nastala neznámá chyba."});break}},onRequestError(){o.addAlert({type:"error",title:"Hodnocení",message:"Nastala chyba při odesílání požadavku."})}}).finally(()=>{y.value=!1})},j=s=>{r.value=s};return R(async()=>{try{await z(`/user_task/get/idUser/idTask?idTask=${p}&idUser=${m}`,{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",async onResponse({response:s}){var k;const t=s._data.data.task,i=s._data.data.task.elaborator,c=s._data.data.task.guarantor;if(!t||!i||!c){await $.push("/panel/tasks/admin");return}a.value={...t,id:t.idTask,review:t.review},N.value=(k=a.value)==null?void 0:k.review,l.value=i,_.value=c}})}catch{await $.push("/panel/tasks/admin");return}}),(s,t)=>{const i=I,c=Y;return b(),E(c,{name:"panel",loading:!a.value||!l.value||!_.value},P({header:f(()=>[u(L,{links:[{name:"Úkoly",path:"/panel/tasks/admin"},{name:`Úkol: ${v(p)}`,path:`/panel/tasks/admin/${v(p)}`},{name:`Uživatel: ${v(m)}`,path:`/panel/tasks/admin/${v(p)}/${v(m)}`}]},null,8,["links"])]),_:2},[a.value&&l.value&&_.value?{name:"content",fn:f(()=>[e("div",Q,[e("div",W,[e("div",ee,[e("div",ae,[e("h3",null,n(a.value.name),1),e("p",null,"Úkol ID: "+n(a.value.id),1),e("p",null,"Garant: "+n(_.value.name)+" "+n(_.value.surname),1),e("p",null,"Začátek: "+n(v(x)(a.value.startDate).format("DD.MM. YYYY HH:MM")),1),e("p",null,"Konec: "+n(v(x)(a.value.endDate).format("DD.MM. YYYY HH:MM")),1),e("p",null,"Nutné potvrzení: "+n(a.value.approve?"Ano":"Ne"),1),e("div",te,[t[0]||(t[0]=e("p",null,"Vypracovává:",-1)),e("div",oe,[e("img",{src:"http://89.203.248.163/uploads/profilePictures/"+l.value.profilePicture,alt:"User profile photo",loading:"lazy"},null,8,se),e("span",null,n(l.value.name)+" "+n(l.value.surname),1)])])])]),e("div",ne,[e("div",le,[t[1]||(t[1]=e("h3",null,"Materiály",-1)),e("div",re,[e("a",{href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${a.value.task}`,class:"link",download:"",target:"_blank"},n(a.value.task),9,ie),e("a",{class:"icon-div",href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${a.value.task}`,download:"",target:"_blank"},[u(i,{class:"icon",name:"material-symbols:download-2-rounded"})],8,de)])])]),e("div",ue,[e("div",ce,[t[3]||(t[3]=e("h3",null,"Vypracování",-1)),a.value.elaboration?(b(),w("div",ve,[e("a",{href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${l.value.id}/elaboration/${a.value.elaboration}`,class:"link",download:"",target:"_blank"},n(a.value.elaboration),9,pe),e("a",{class:"icon-div",href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${l.value.id}/elaboration/${a.value.elaboration}`,download:"",target:"_blank"},[u(i,{class:"icon",name:"material-symbols:download-2-rounded"})],8,me)])):(b(),w("p",_e,t[2]||(t[2]=[e("span",{class:"error"},"Uživatel ještě nevypracoval tento úkol.",-1)])))])]),e("div",ke,[u(X,{reset:g.value,"old-task-file":a.value.review,onUpdate:j},{default:f(()=>[e("div",he,[e("h3",null,[t[4]||(t[4]=A("Hodnocení ")),S(e("span",fe,"(aktualizováno)",512),[[B,r.value!==void 0]])]),t[5]||(t[5]=e("p",null,"Zde můžete nahrát nebo stáhnout soubor s hodnocením úkolu. Povolené formáty: PDF, DOCX, ODT, HTML nebo ZIP.",-1))])]),_:1},8,["reset","old-task-file"]),e("div",be,[e("button",{class:"icon-div",onClick:M},[u(i,{class:"icon",name:"material-symbols:delete"})]),h.value||a.value.review?(b(),w("a",{key:0,class:"icon-div",href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${l.value.id}/review/${h.value||a.value.review}`,download:"",target:"_blank"},[u(i,{class:"icon",name:"material-symbols:download-2-rounded"})],8,ye)):Z("",!0)])]),u(J,{"is-loading":y.value,"reset-function":F,"submit-function":T},{default:f(()=>t[6]||(t[6]=[A(" Pole označená * jsou povinná ")])),_:1},8,["is-loading"])])]),u(G)]),key:"0"}:void 0]),1032,["loading"])}}}),Re=q(ge,[["__scopeId","data-v-0fea0077"]]);export{Re as default};
//# sourceMappingURL=C6T5r7mM.js.map
