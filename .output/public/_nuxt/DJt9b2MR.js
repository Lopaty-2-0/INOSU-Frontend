import H from"./dFJnGj4t.js";import{e as P,z as R,s as S,r as i,j as U,E as Y,k as j,l as B,w as h,m as Z,o as b,a as e,b as r,t as s,u as p,d as T,h as q,q as L,c as w,g as O,_ as K}from"./DFLv1YV6.js";import{N as X}from"./gU5XJUlO.js";import{a as z}from"./BUVrFq-o.js";import{m as A}from"./qbsqZPAI.js";import{u as G,_ as J}from"./CQ3zrzCx.js";import{u as Q}from"./CJYBnIlQ.js";import{E as W}from"./DXU66PW6.js";import{E as ee}from"./cmjTL5kT.js";import{u as ae}from"./CZ6KBkoC.js";import"./COvE1TAq.js";import"./DzoiDIvV.js";import"./C2O9fF6a.js";import"./XGKoS8Uj.js";const te={id:"task"},oe={class:"content"},se={class:"line page-section"},le={class:"section-head"},ne={class:"profile"},ie={class:"data"},re=["src"],de={class:"line page-section"},ue={class:"section-head"},ce={class:"line file"},ve=["href"],pe=["href"],me={class:"line page-section review"},_e={class:"section-head"},ke={class:"update"},fe={class:"column"},he=["href"],be={class:"line page-section"},ye={class:"section-head"},ge={key:0,class:"line file"},we=["href"],$e=["href"],De={key:1},Ve=P({__name:"[taskId]",setup(Ne){const $=R(),D=Y(),m=$.params.taskId,k=$.params.role;ae({title:"Panel | Vypracování úkolu: "+m,meta:[{name:"description",content:"Panel Homepage"}]});const d=G(),F=Q(),{getId:V}=S(F),a=i(void 0),c=i(void 0),v=i(void 0),l=i(void 0),y=i(!1),f=i(void 0),N=i(void 0),g=i(!1),M=()=>{a.value&&(a.value.elaboration=N.value),l.value=void 0},E=()=>{f.value=void 0,l.value=void 0,a.value&&(a.value.elaboration=void 0),g.value=!0,setTimeout(()=>{g.value=!1},100)},I=async()=>{y.value=!0;const o=new FormData;o.append("idTask",m),o.append("idUser",V.value),o.append("elaboration",l.value||""),await z("/user_task/update",{method:"put",body:o,credentials:"include",ignoreResponseError:!0,async onResponse({response:t}){var u,_,x;switch((u=t._data.resCode)==null?void 0:u.toString()){case"38010":d.addAlert({type:"error",title:"Vypracování",message:"Nebyl zadán id úkolu."});break;case"38020":d.addAlert({type:"error",title:"Vypracování",message:"Uživatel neexistuje."});break;case"38030":d.addAlert({type:"error",title:"Vypracování",message:"Úkol neexistuje."});break;case"38040":d.addAlert({type:"error",title:"Vypracování",message:"Záznam user_task neexistuje."});break;case"38111":d.addAlert({type:"success",title:"Vypracování",message:"Vypracování bylo úspěšně aktualizováno."}),a.value&&(a.value.elaboration=((_=l.value)==null?void 0:_.name)||void 0,f.value=(x=l.value)==null?void 0:x.name),l.value=void 0;break;default:d.addAlert({type:"error",title:"Vypracování",message:"Nastala neznámá chyba."});break}},onRequestError(){d.addAlert({type:"error",title:"Vypracování",message:"Nastala chyba při odesílání požadavku."})}}).finally(()=>{y.value=!1})},C=o=>{l.value=o};return U(async()=>{try{await z(`/user_task/get/idUser/idTask?idTask=${m}&idUser=${V.value}`,{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",async onResponse({response:o}){var _;const t=o._data.data.task,n=o._data.data.task.elaborator,u=o._data.data.task.guarantor;if(!t||!n||!u){await D.push(`/panel/tasks/${k}`);return}a.value={...t,id:t.idTask,elaboration:t.elaboration},N.value=(_=a.value)==null?void 0:_.elaboration,c.value=n,v.value=u}})}catch{await D.push(`/panel/tasks/${k}`);return}}),(o,t)=>{const n=H,u=Z;return b(),j(u,{name:"panel",loading:!a.value||!c.value||!v.value},B({header:h(()=>[r(X,{links:[{name:"Úkoly",path:`/panel/tasks/${p(k)}`},{name:`Úkol: ${p(m)}`,path:`/panel/tasks/${p(k)}/${p(m)}`}]},null,8,["links"])]),_:2},[a.value&&c.value&&v.value?{name:"content",fn:h(()=>[e("div",te,[e("div",oe,[e("div",se,[e("div",le,[e("h3",null,s(a.value.name),1),e("p",null,"Úkol ID: "+s(a.value.id),1),e("p",null,"Začátek: "+s(p(A)(a.value.startDate).format("DD.MM. YYYY HH:MM")),1),e("p",null,"Konec: "+s(p(A)(a.value.endDate).format("DD.MM. YYYY HH:MM")),1),e("p",null,"Nutné potvrzení: "+s(a.value.approve?"Ano":"Ne"),1),e("div",ne,[t[0]||(t[0]=e("p",null,"Autor:",-1)),e("div",ie,[e("img",{src:"http://89.203.248.163/uploads/profilePictures/"+v.value.profilePicture,alt:"User profile photo",loading:"lazy"},null,8,re),e("span",null,s(v.value.name)+" "+s(v.value.surname),1)])])])]),e("div",de,[e("div",ue,[t[1]||(t[1]=e("h3",null,"Materiály",-1)),e("div",ce,[e("a",{href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${a.value.task}`,class:"link",download:"",target:"_blank"},s(a.value.task),9,ve),e("a",{class:"icon-div",href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${a.value.task}`,download:"",target:"_blank"},[r(n,{class:"icon",name:"material-symbols:download-2-rounded"})],8,pe)])])]),e("div",me,[r(W,{reset:g.value,"old-task-file":a.value.elaboration,onUpdate:C},{default:h(()=>[e("div",_e,[e("h3",null,[t[2]||(t[2]=T("Vypracování ")),q(e("span",ke,"(aktualizováno)",512),[[L,l.value!==void 0]])]),t[3]||(t[3]=e("p",null,"Zde můžete nahrát nebo aktualizovat své vypracování úkolu. Vyberte soubor a potvrďte změny. Povolené formáty: PDF, DOCX, ODT, HTML nebo ZIP.",-1))])]),_:1},8,["reset","old-task-file"]),e("div",fe,[e("button",{class:"icon-div",onClick:E},[r(n,{class:"icon",name:"material-symbols:delete"})]),f.value||a.value.elaboration?(b(),w("a",{key:0,class:"icon-div",href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${c.value.id}/elaboration/${f.value||a.value.elaboration}`,download:"",target:"_blank"},[r(n,{class:"icon",name:"material-symbols:download-2-rounded"})],8,he)):O("",!0)])]),e("div",be,[e("div",ye,[t[5]||(t[5]=e("h3",null,"Hodnocení",-1)),a.value.review?(b(),w("div",ge,[e("a",{href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${c.value.id}/review/${a.value.review}`,class:"link",download:"",target:"_blank"},s(a.value.review),9,we),e("a",{class:"icon-div",href:`http://89.203.248.163/uploads/tasks/${a.value.id}/${c.value.id}/review/${a.value.review}`,download:"",target:"_blank"},[r(n,{class:"icon",name:"material-symbols:download-2-rounded"})],8,$e)])):(b(),w("p",De,t[4]||(t[4]=[e("span",{class:"error"},"Hodnocení ještě nebylo přiloženo.",-1)])))])]),r(ee,{"is-loading":y.value,"reset-function":M,"submit-function":I},{default:h(()=>t[6]||(t[6]=[T(" Pole označená * jsou povinná ")])),_:1},8,["is-loading"])])]),r(J)]),key:"0"}:void 0]),1032,["loading"])}}}),Ye=K(Ve,[["__scopeId","data-v-6068ab9f"]]);export{Ye as default};
//# sourceMappingURL=DJt9b2MR.js.map
