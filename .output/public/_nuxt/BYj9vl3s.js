import x from"./D0YqDxnM.js";import{u as H,_ as P}from"./Z5wW8-57.js";import{e as D,z as j,r as k,j as C,k as R,l as S,w as _,m as $,E as I,o as M,a as e,b as p,u,t as r,d as T,h as E,v as U,_ as Y}from"./CUZeRvXC.js";import{N as V}from"./DCknVipl.js";import{W as Z}from"./DX0GD6l3.js";/* empty css        */import{A as B}from"./CZPl7iRn.js";import{a as b}from"./CkL4TXxs.js";import{m as h}from"./qbsqZPAI.js";import{N as F}from"./C0GUIwSb.js";import{u as q}from"./Db-zqWpw.js";import"./BggygjHh.js";import"./DaNuMFcU.js";import"./CnmWWN_2.js";import"./Bz2aGY34.js";import"./DU8lQhTt.js";const O={id:"tasks"},W={class:"content"},G={class:"line"},J={class:"line"},K={class:"line"},L={class:"section-head"},Q={class:"section-head"},X=["href"],ee={class:"search"},te={class:"profile"},ae=["src"],oe={class:"uppercase"},se={class:"actions"},ne=["onClick"],re=["onClick"],le=D({__name:"index",setup(ie){const f=j(),z=I(),l=f.params.taskId;q({title:"Panel | Žádosti o úkol - "+l,meta:[{name:"description",content:"Panel Homepage"}]});const t=H(),s=k(void 0),c=k(!1),A=k([{field:"id",title:"ID",width:"90px",type:"number"},{field:"name",title:"Žadatel",type:"string"},{field:"abbreviation",title:"Zkratka",type:"date"},{field:"email",title:"E-mail",type:"string"},{field:"actions",title:"Akce"}]),i=k(void 0),y=k(""),N=async n=>{c.value=!0;const a=new FormData;a.append("idTask",l),a.append("idUser",n.toString()),a.append("status","approved"),await b("/user_task/update",{method:"put",body:a,credentials:"include",ignoreResponseError:!0,onResponse({response:m}){var d,o;switch((d=m._data.resCode)==null?void 0:d.toString()){case"38010":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Nebyl zadán id úkolu."});break;case"38020":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Uživatel neexistuje."});break;case"38030":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Úkol neexistuje."});break;case"38040":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Záznam s uživatelem a úkolem neexistuje."});break;case"38050":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Špatný formát souboru (review)."});break;case"38060":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Nelze provést tuto akci (review lze nahrát jen u schváleného úkolu)."});break;case"38070":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Název souboru (review) je příliš dlouhý."});break;case"38100":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Nemáte oprávnění."});break;case"38111":t.addAlert({type:"success",title:"Potvrzení úkolu",message:"Úkol byl úspěšně potvrzen."}),i.value=(o=i.value)==null?void 0:o.filter(v=>Number(v.id)!==n);break;default:t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Nastala neznámá chyba."});break}},onRequestError(){t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Nastala neznámá chyba při odesílání požadavku."})}}).finally(()=>{c.value=!1})},w=async n=>{c.value=!0;const a=new FormData;a.append("idTask",l),a.append("idUser",n.toString()),a.append("status","rejected"),await b("/user_task/update",{method:"put",body:a,credentials:"include",ignoreResponseError:!0,onResponse({response:m}){var d,o;switch((d=m._data.resCode)==null?void 0:d.toString()){case"38010":t.addAlert({type:"error",title:"Hodnocení",message:"Nebyl zadán id úkolu."});break;case"38020":t.addAlert({type:"error",title:"Hodnocení",message:"Uživatel neexistuje."});break;case"38030":t.addAlert({type:"error",title:"Hodnocení",message:"Úkol neexistuje."});break;case"38040":t.addAlert({type:"error",title:"Hodnocení",message:"Záznam user_task neexistuje."});break;case"38050":t.addAlert({type:"error",title:"Hodnocení",message:"Špatný formát souboru (review)."});break;case"38060":t.addAlert({type:"error",title:"Hodnocení",message:"Nelze provést tuto akci (review lze nahrát jen u schváleného úkolu)."});break;case"38070":t.addAlert({type:"error",title:"Hodnocení",message:"Název souboru (review) je příliš dlouhý."});break;case"38080":t.addAlert({type:"error",title:"Vypracování",message:"Špatný formát souboru (elaboration)."});break;case"38090":t.addAlert({type:"error",title:"Vypracování",message:"Název souboru (elaboration) je příliš dlouhý."});break;case"38100":t.addAlert({type:"error",title:"Hodnocení",message:"Nemáte oprávnění."});break;case"38111":t.addAlert({type:"success",title:"Hodnocení",message:"Hodnocení bylo úspěšně aktualizováno."}),i.value=(o=i.value)==null?void 0:o.filter(v=>Number(v.id)!==n);break;default:t.addAlert({type:"error",title:"Hodnocení",message:"Nastala neznámá chyba."});break}},onRequestError(){t.addAlert({type:"error",title:"Zamítnutí úkolu",message:"Nastala neznámá chyba při odesílání požadavku."})}}).finally(()=>{c.value=!1})};return C(async()=>{await b(`/task/get/id?idTask=${l}`,{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,async onResponse({response:n}){const a=n._data.data.task;if(!a){await z.push("/panel/tasks/admin");return}s.value=a}}),await b(`/user_task/get/status/idTask?idTask=${l}&status=${encodeURIComponent(JSON.stringify(["pending"]))}`,{method:"get",credentials:"include",ignoreResponseError:!0,onResponse({response:n}){i.value=(n._data.data.tasks||[]).map(a=>a.elaborator)||[]}})}),(n,a)=>{const m=x,g=P,d=$;return M(),R(d,{name:"panel",loading:!i.value||!s.value},S({header:_(()=>[p(V,{links:[{name:"Úkoly",path:"/panel/tasks/admin"},{name:"Žádosti",path:`/panel/tasks/admin/${u(l)}`}]},null,8,["links"])]),_:2},[i.value&&s.value?{name:"content",fn:_(()=>[e("div",O,[e("div",W,[p(B,{class:"action-bar",description:"Správa úkolů",texts:["Přidat","Odebrat"],actions:["add","remove"],icons:["material-symbols:add-rounded","material-symbols:delete-rounded"],"navigate-to":["/panel/tasks/admin/add","/panel/tasks/admin/remove"]}),e("div",G,[p(F,{class:"navigation",title:"Úkoly","active-link-id":0,links:[{name:"Žádosti",path:`/panel/tasks/admin/${u(l)}`},{name:"Rozpracované",path:`/panel/tasks/admin/${u(l)}/inProgress`},{name:"Vypracované",path:`/panel/tasks/admin/${u(l)}/done`}]},null,8,["links"]),e("div",J,[e("div",K,[e("div",L,[e("div",Q,[a[2]||(a[2]=e("h3",null,"Žádosti o úkol",-1)),e("p",null,"Úkol ID: "+r(s.value.id),1),e("p",null,"Název: "+r(s.value.name),1),e("p",null,"Garant ID: "+r(s.value.guarantor),1),e("p",null,"Začátek: "+r(u(h)(s.value.startDate).format("DD.MM. YYYY HH:MM")),1),e("p",null,"Konec: "+r(u(h)(s.value.endDate).format("DD.MM. YYYY HH:MM")),1),e("p",null,"Nutné potvrzení: "+r(s.value.approve?"Ano":"Ne"),1),e("p",null,[a[1]||(a[1]=T(" Zadání: ")),e("a",{href:`http://89.203.248.163/uploads/tasks/${s.value.id}/${s.value.task}`,class:"link",download:"",target:"_blank"},r(s.value.task),9,X)])])]),e("div",ee,[E(e("input",{type:"text",name:"searchInput",placeholder:"Hledat uživatele","onUpdate:modelValue":a[0]||(a[0]=o=>y.value=o)},null,512),[[U,y.value]]),p(m,{class:"icon",name:"material-symbols:search-rounded"})])]),p(u(Z),{loading:c.value,rows:i.value,columns:A.value,pageSize:10,sortable:!0,search:y.value},{name:_(o=>[e("div",te,[e("img",{src:"http://89.203.248.163/uploads/profilePictures/"+o.value.profilePicture,alt:"User profile photo",loading:"lazy"},null,8,ae),e("p",null,r(o.value.name)+" "+r(o.value.surname),1)])]),abbreviation:_(o=>[e("p",oe,r(o.value.abbreviation||"Není"),1)]),actions:_(o=>[e("div",se,[e("button",{type:"button",class:"accept",onClick:v=>N(o.value.id)},"Přijmout",8,ne),e("button",{type:"button",class:"deny",onClick:v=>w(o.value.id)},"Zamítnout",8,re)])]),_:1},8,["loading","rows","columns","search"])])])])]),p(g)]),key:"0"}:void 0]),1032,["loading"])}}}),we=Y(le,[["__scopeId","data-v-3ba40ac1"]]);export{we as default};
//# sourceMappingURL=BYj9vl3s.js.map
