import{e as b,r as p,j as _,y as z,c as r,g as n,b as m,a,f as A,h as c,v as w,t as v,x as j,F as C,o as t,_ as R}from"./J7-yQi-K.js";import{L as f}from"./Qpf0i4a6.js";import{a as g}from"./C0hwI7pc.js";import{u as N}from"./PCjTfg1e.js";const x={key:0,id:"forgetPassword-reset-error"},T={key:0,class:"loading-big"},E={key:1,class:"container card"},P={key:1,id:"forgetPassword-reset"},S={class:"container"},F={class:"section"},M={key:0,class:"error"},V={class:"section"},Z={key:0,class:"error"},H={class:"footer"},B={key:0,class:"loading"},D=b({__name:"reset",setup(q){N({title:"Panel | Resetování hesla",meta:[{name:"description",content:"Resetování hesla"}]});const e=p({password:null,passwordAgain:null,form:{message:null,type:null}}),d=p(!0),l=p(null),o=p({password:"",passwordAgain:""}),y=()=>{o.value.password.length<5&&(e.value.password="Nové heslo musí mít nejméně 5 znaků"),o.value.password||(e.value.password="Zadejte nové heslo"),o.value.passwordAgain?o.value.passwordAgain!==o.value.password&&(e.value.passwordAgain="Hesla se neshodují"):e.value.passwordAgain="Zadejte heslo znovu"},h=()=>{e.value={password:null,passwordAgain:null,form:{message:null,type:null}}},k=async()=>{y(),!(e.value.password||e.value.passwordAgain||e.value.form.type==="error")&&(d.value=!0,await g("/user/password/reset",{method:"POST",headers:{"Content-Type":"application/json"},body:{email:l.value,newPassword:o.value.password},credentials:"include",ignoreResponseError:!0,async onResponse({response:u}){switch(u._data.resCode.toString()){case"14010":e.value.form={message:"Účet nebyl nalezen",type:"error"};break;case"14030":e.value.form={message:"Nové heslo musí mít nejméně 5 znaků",type:"error"};break;case"14041":e.value.form={message:"Heslo bylo úspěšně změněno",type:"success"};break;default:e.value.form={message:"Nastala neznámá chyba",type:"error"};break}},async onRequestError(){e.value.form={message:"Nastala neznámá chyba",type:"error"}}}),d.value=!1)};return _(async()=>{const u=z().query.token;u||(l.value=null),await g("/user/password/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:{token:u},ignoreResponseError:!0,async onResponse({response:s}){switch(s._data.resCode.toString()){case"13021":l.value=s._data.data.email;break;default:l.value=null;break}},async onResponseError(){l.value=null}}),d.value=!1}),(u,s)=>(t(),r(C,null,[l.value?n("",!0):(t(),r("div",x,[d.value?(t(),r("div",T,[m(f,{color:"rgba(var(--description-color), 1)",size:"24px"})])):n("",!0),d.value?n("",!0):(t(),r("div",E,s[2]||(s[2]=[a("div",{class:"head"},[a("h2",null,"Token je neplatný"),a("p",null," Token pro resetování hesla je neplatný nebo vypršel, je potřeba vytvořit nový token a zkusit to znovu ")],-1),a("div",{class:"footer"},[a("a",{href:"/password/forget/new"},[a("button",{type:"submit"},"Zkusit znovu")])],-1)])))])),l.value?(t(),r("div",P,[a("div",S,[s[7]||(s[7]=a("div",{class:"head"},[a("h2",null,"Změna hesla"),a("p",null,"Resetujte si heslo k vašemu účtu zadáním nového hesla")],-1)),a("form",{onSubmit:A(k,["prevent"]),onInput:h},[a("div",F,[s[3]||(s[3]=a("label",{for:"password"},"Nové heslo",-1)),c(a("input",{type:"password",id:"password",name:"password",placeholder:"*****","onUpdate:modelValue":s[0]||(s[0]=i=>o.value.password=i)},null,512),[[w,o.value.password]]),e.value.password?(t(),r("p",M,v(e.value.password),1)):n("",!0)]),a("div",V,[s[4]||(s[4]=a("label",{for:"passwordAgain"},"Heslo znovu",-1)),c(a("input",{type:"password",id:"passwordAgain",name:"passwordAgain",placeholder:"*****","onUpdate:modelValue":s[1]||(s[1]=i=>o.value.passwordAgain=i)},null,512),[[w,o.value.passwordAgain]]),e.value.passwordAgain?(t(),r("p",Z,v(e.value.passwordAgain),1)):n("",!0)]),a("div",H,[s[5]||(s[5]=a("button",{type:"submit"},"Změnit heslo",-1)),e.value.form.message?(t(),r("p",{key:0,class:j({error:e.value.form.type==="error",success:e.value.form.type==="success"})},v(e.value.form.message),3)):n("",!0)]),d.value?(t(),r("div",B,[m(f,{color:"rgba(var(--description-color), 1)",size:"6px"})])):n("",!0),s[6]||(s[6]=a("a",{href:"/"},"Máte změněno?",-1))],32)])])):n("",!0)],64))}}),G=R(D,[["__scopeId","data-v-8d38d3fe"]]);export{G as default};
//# sourceMappingURL=DEngppOw.js.map
