import{e as U,r as u,i as R,j as T,k as g,w as n,m as C,o as y,a as e,b as i,d as r,h as v,q as p,c as N,_ as x}from"./qt0h0kFv.js";import{E as S}from"./BGsHjZEK.js";import{u as V,_ as Z}from"./fzoHn8T8.js";import{N as F}from"./2dFQOzvg.js";import{E as H,a as B,b as D,c as J}from"./CAASxXnC.js";import{E as q}from"./knE0KiVw.js";import{E as I}from"./BCow7xK2.js";import{a as _}from"./CI6GBMjg.js";import{u as L}from"./KD0uSQAu.js";import"./CI2UeAAB.js";import"./BOQHfSiJ.js";import"./DgTH69TZ.js";import"./DjacMGf3.js";import"./DZFHCepi.js";import"./DlhrDTwY.js";const M={id:"settings"},O={class:"content"},G={class:"line page-section"},K={class:"line page-section"},Q={class:"section-head"},W={class:"update"},X={class:"line page-section"},Y={class:"section-head"},$={class:"update"},ee={class:"line page-section"},ae={class:"section-head"},se={class:"update"},te={class:"line page-section"},oe={class:"section-head"},le={class:"update"},ne={class:"line page-section"},ie={class:"section-head"},re={class:"update"},de={key:1,class:"error"},ue=U({__name:"add",setup(ve){L({title:"Panel | Uživatelé - Přidání",meta:[{name:"description",content:"Panel Settings User Information"}]});const o=V(),m=u(!1),l=u(!1),c=u(void 0),b=u(void 0),d=R(()=>({name:"",surname:"",email:"",password:"",abbreviation:"",role:"",classes:[]})),s=u({name:void 0,surname:void 0,email:void 0,password:void 0,abbreviation:void 0,role:void 0,classes:void 0}),f=t=>{s.value.name=t.name,s.value.surname=t.surname},h=t=>{s.value.email=t.email},j=t=>{s.value.password=t.password},P=t=>{s.value.abbreviation=t.abbreviation},w=t=>{s.value.role=t.role},E=t=>{s.value.classes=t.classes},k=()=>{s.value={name:void 0,surname:void 0,email:void 0,password:void 0,abbreviation:void 0,role:void 0,classes:void 0},l.value=!0,setTimeout(()=>{l.value=!1},100)},A=async()=>{if(!s.value.name||!s.value.surname||!s.value.email||!s.value.password||!s.value.role){o.addAlert({type:"error",title:"Přidání uživatele",message:"Vyplňte všechna povinná pole."});return}m.value=!0,await _("/user/add",{method:"POST",headers:{"Content-Type":"application/json"},body:{name:s.value.name,surname:s.value.surname,email:s.value.email,password:s.value.password,abbreviation:s.value.abbreviation,role:s.value.role,classes:s.value.classes},credentials:"include",ignoreResponseError:!0,async onResponse({response:t}){switch(t._data.resCode.toString()){case"1020":o.addAlert({type:"error",title:"Přidání uživatele",message:"Jméno nebylo zadáno."});break;case"1030":o.addAlert({type:"error",title:"Přidání uživatele",message:"Jméno je příliš dlouhé."});break;case"1040":o.addAlert({type:"error",title:"Přidání uživatele",message:"Příjmení nebylo zadáno."});break;case"1050":o.addAlert({type:"error",title:"Přidání uživatele",message:"Příjmení je příliš dlouhé."});break;case"1060":o.addAlert({type:"error",title:"Přidání uživatele",message:"Role nebyla zadána."});break;case"1070":o.addAlert({type:"error",title:"Přidání uživatele",message:"Role je příliš dlouhá."});break;case"1080":o.addAlert({type:"error",title:"Přidání uživatele",message:"Heslo nebylo zadáno."});break;case"1090":o.addAlert({type:"error",title:"Přidání uživatele",message:"Heslo je příliš krátké."});break;case"1100":o.addAlert({type:"error",title:"Přidání uživatele",message:"E-mail nebyl zadán."});break;case"1110":o.addAlert({type:"error",title:"Přidání uživatele",message:"Špatný formát e-mailu."});break;case"1120":o.addAlert({type:"error",title:"Přidání uživatele",message:"E-mail je příliš dlouhý."});break;case"1130":o.addAlert({type:"error",title:"Přidání uživatele",message:"E-mail je již používán."});break;case"1140":o.addAlert({type:"error",title:"Přidání uživatele",message:"Zkratka je již používána."});break;case"1150":o.addAlert({type:"error",title:"Přidání uživatele",message:"Zkratka je příliš dlouhá."});break;case"1161":o.addAlert({type:"success",title:"Přidání uživatele",message:"Uživatel byl úspěšně přidán."}),k();break;default:o.addAlert({type:"error",title:"Přidání uživatele",message:"Nastala neznámá chyba."});break}},async onRequestError(){o.addAlert({type:"error",title:"Přidání uživatele",message:"Nastala neznámá chyba."})}}).finally(()=>{m.value=!1})};return T(async()=>{await _("/user/get/roles",{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,onResponse({response:t}){const a=t._data.data.roles;c.value=a||[]}}),await _("/class/get",{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,onResponse({response:t}){const a=t._data.data.classes;b.value=a||[]}})}),(t,a)=>{const z=C;return y(),g(z,{name:"panel",loading:!c.value||!b.value},{header:n(()=>[i(F,{links:[{name:"Uživatelé",path:"/panel/users"},{name:"Přidání",path:"/panel/users/add"}]})]),content:n(()=>[e("div",M,[e("div",O,[e("div",G,[i(H,{"old-full-name":{name:d.value.name,surname:d.value.surname},reset:l.value,onUpdate:f},{default:n(()=>a[0]||(a[0]=[e("div",{class:"section-head"},[e("h3",null,"Jméno a příjmení *"),e("p",null,"Zadejte jméno a příjmení nového uživatele. Tato pole jsou povinná.")],-1)])),_:1},8,["old-full-name","reset"])]),e("div",K,[i(B,{"old-email":d.value.email,reset:l.value,onUpdate:h},{default:n(()=>[e("div",Q,[e("h3",null,[a[1]||(a[1]=r("E-mail * ")),v(e("span",W,"(aktualizováno)",512),[[p,s.value.email]])]),a[2]||(a[2]=e("p",null,"Zadejte e-mailovou adresu nového uživatele. Toto pole je povinné a musí být ve správném formátu.",-1))])]),_:1},8,["old-email","reset"])]),e("div",X,[i(q,{type:"new",reset:l.value,onUpdate:j},{default:n(()=>[e("div",Y,[e("h3",null,[a[3]||(a[3]=r("Heslo k účtu * ")),v(e("span",$,"(aktualizováno)",512),[[p,s.value.password]])]),a[4]||(a[4]=e("p",null,"Zadejte silné heslo pro nového uživatele. Heslo musí splňovat bezpečnostní požadavky a je povinné.",-1))])]),_:1},8,["reset"])]),e("div",ee,[i(D,{roles:c.value||[],"old-role":d.value.role,reset:l.value,onUpdate:w},{default:n(()=>[e("div",ae,[e("h3",null,[a[5]||(a[5]=r("Role * ")),v(e("span",se,"(aktualizováno)",512),[[p,s.value.role]])]),a[6]||(a[6]=e("p",null,"Vyberte roli, kterou má mít nový uživatel. Toto pole je povinné.",-1))])]),_:1},8,["roles","old-role","reset"])]),e("div",te,[i(J,{"full-name":{name:s.value.name,surname:s.value.surname},"old-abbreviation":d.value.abbreviation,reset:l.value,onUpdate:P},{default:n(()=>[e("div",oe,[e("h3",null,[a[7]||(a[7]=r("Přezdívka ")),v(e("span",le,"(aktualizováno)",512),[[p,s.value.abbreviation]])]),a[8]||(a[8]=e("p",null,"Zadejte přezdívku (zkratku) pro nového uživatele. Toto pole je volitelné, ale musí být jedinečné.",-1))])]),_:1},8,["full-name","old-abbreviation","reset"])]),e("div",ne,[e("div",ie,[e("h3",null,[a[9]||(a[9]=r("Třídy ")),v(e("span",re,"(aktualizováno)",512),[[p,s.value.classes]])]),a[10]||(a[10]=e("p",null,"Vyberte třídy, do kterých bude nový uživatel (student) zařazen. Toto pole je volitelné.",-1))]),s.value.role==="student"?(y(),g(I,{key:0,"old-class-ids":d.value.classes,classes:b.value||[],reset:l.value,onUpdate:E},null,8,["old-class-ids","classes","reset"])):(y(),N("p",de,a[11]||(a[11]=[r(" Třídy můžete vybírat pouze pokud role uživatele je "),e("strong",null,"student",-1),r(". ")])))]),i(S,{"is-loading":m.value,"reset-function":k,"submit-function":A},{default:n(()=>a[12]||(a[12]=[r(" Pole označená * jsou povinná ")])),_:1},8,["is-loading"])]),i(Z)])]),_:1},8,["loading"])}}}),ze=x(ue,[["__scopeId","data-v-bb73f47d"]]);export{ze as default};
//# sourceMappingURL=DNMUdj-4.js.map
