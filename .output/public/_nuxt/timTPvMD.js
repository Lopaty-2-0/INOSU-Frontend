import w from"./CLz_XDSv.js";import{u as N,_ as D}from"./CKKYFl9L.js";import{e as z,z as x,s as T,r as v,j as C,k as S,l as M,w as d,m as R,o as Y,a,b as m,u as i,h as $,v as H,t as y,_ as I}from"./J7-yQi-K.js";import{N as E}from"./CR_H3JQR.js";import{W as U}from"./DjJD5J-C.js";/* empty css        */import{a as b}from"./C0hwI7pc.js";import{m as f}from"./qbsqZPAI.js";import{N as V}from"./QlyHuZOE.js";import{u as Z}from"./C6MNyRTM.js";import{u as B}from"./PCjTfg1e.js";import"./BZ59wu3D.js";import"./Qpf0i4a6.js";import"./CtpsiGFq.js";import"./DxXzBOxs.js";const q={id:"tasks"},F={class:"content"},W={class:"line"},K={class:"line"},L={class:"line"},G={class:"search"},J=["href"],O={class:"actions"},Q=["onClick"],X=z({__name:"available",setup(ee){B({title:"Panel | Dostupné úkoly",meta:[{name:"description",content:"Panel Homepage"}]});const u=x().params.role,h=Z(),e=N(),{getId:g}=T(h),j=v([{field:"id",title:"ID",width:"90px",type:"number"},{field:"name",title:"Název",type:"string"},{field:"startDate",title:"Začátek",type:"date"},{field:"endDate",title:"Konec",type:"date"},{field:"task",title:"Zadání",type:"string"},{field:"actions",title:"Akce"}]),l=v(void 0),_=v(""),k=v(!1),A=async(r,o)=>{if(k.value=!0,o==="classTask"){await b("/user_task/add",{method:"post",body:{idTask:r,idUser:g.value},credentials:"include",ignoreResponseError:!0,headers:{"Content-Type":"application/json"},onResponse({response:s}){var p,t;switch((p=s._data.resCode)==null?void 0:p.toString()){case"36010":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nebyl zadán id úkolu."});break;case"36020":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nebyl zadán id uživatele."});break;case"36030":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Úkol neexistuje."});break;case"36040":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Záznam nebyl vytvořen."});break;case"36051":e.addAlert({type:"success",title:"Přijetí úkolu",message:"Úkol byl úspěšně přijat a čeká na schválení."}),l.value=(t=l.value)==null?void 0:t.filter(c=>c.id!==r);break;default:e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nastala neznámá chyba."});break}},onRequestError(){e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nastala neznámá chyba."})}}).finally(()=>{k.value=!1});return}if(o==="waitingTask"){const s=new FormData;s.append("idTask",r.toString()),s.append("idUser",g.value),s.append("status","pending"),await b("/user_task/update",{method:"put",body:s,credentials:"include",ignoreResponseError:!0,onResponse({response:n}){var t,c;switch((t=n._data.resCode)==null?void 0:t.toString()){case"38010":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nebyl zadán id úkolu."});break;case"38020":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Uživatel neexistuje."});break;case"38030":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Úkol neexistuje."});break;case"38040":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Záznam s uživatelem a úkolem neexistuje."});break;case"38050":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Špatný formát souboru (review)."});break;case"38060":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nelze provést tuto akci (review není povoleno)."});break;case"38070":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Název souboru (review) je příliš dlouhý."});break;case"38080":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Špatný formát souboru (elaboration)."});break;case"38090":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Název souboru (elaboration) je příliš dlouhý."});break;case"38100":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nedostatečná oprávnění."});break;case"38111":e.addAlert({type:"success",title:"Přijetí úkolu",message:"Úkol byl úspěšně přijat a čeká na schválení."}),l.value=(c=l.value)==null?void 0:c.filter(P=>P.id!==r);break;default:e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nastala neznámá chyba."});break}},onRequestError(){e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nastala neznámá chyba."})}}).finally(()=>{k.value=!1});return}};return C(async()=>{await b("/task/get/possible",{method:"get",credentials:"include",ignoreResponseError:!0,onResponse({response:r}){const o=r._data.data.classTasks.map(n=>({...n,from:"classTask"}))||[],s=r._data.data.waitingTasks.map(n=>({...n,from:"waitingTask"}))||[];l.value=[...o,...s]}})}),(r,o)=>{const s=w,n=D,p=R;return Y(),S(p,{name:"panel",loading:!l.value},M({header:d(()=>[m(E,{links:[{name:"Úkoly",path:`/panel/tasks/${i(u)}`}]},null,8,["links"])]),_:2},[l.value?{name:"content",fn:d(()=>[a("div",q,[a("div",F,[a("div",W,[m(V,{class:"navigation",title:"Úkoly","active-link-id":1,links:[{name:"Aktivní",path:`/panel/tasks/${i(u)}`},{name:"Dostupné",path:`/panel/tasks/${i(u)}/available`},{name:"Stav úkolů",path:`/panel/tasks/${i(u)}/status`},{name:"Vyhodnocené",path:`/panel/tasks/${i(u)}/evaluated`}]},null,8,["links"]),a("div",K,[a("div",L,[o[1]||(o[1]=a("div",{class:"section-head"},[a("h3",null,"Dostupné úkoly"),a("p",null,"tyto úkoly vyžadují potvrzení tvůrce úkolu")],-1)),a("div",G,[$(a("input",{type:"text",name:"searchInput",placeholder:"Hledat úkol","onUpdate:modelValue":o[0]||(o[0]=t=>_.value=t)},null,512),[[H,_.value]]),m(s,{class:"icon",name:"material-symbols:search-rounded"})])]),m(i(U),{loading:k.value,rows:l.value,columns:j.value,pageSize:10,sortable:!0,search:_.value},{task:d(t=>[a("a",{href:`http://89.203.248.163/uploads/tasks/${t.value.id}/${t.value.task}`,class:"link",download:"",target:"_blank"},y(t.value.task),9,J)]),startDate:d(t=>[a("p",null,y(i(f)(t.value.startDate).format("DD.MM. YYYY HH:MM")),1)]),endDate:d(t=>[a("p",null,y(i(f)(t.value.endDate).format("DD.MM. YYYY HH:MM")),1)]),approve:d(t=>[a("p",null,y(t.value.approve?"Ano":"Ne"),1)]),actions:d(t=>[a("div",O,[a("button",{type:"button",class:"add",onClick:c=>A(t.value.id,t.value.from)},"Přijmout",8,Q)])]),_:1},8,["loading","rows","columns","search"])])])])]),m(n)]),key:"0"}:void 0]),1032,["loading"])}}}),_e=I(X,[["__scopeId","data-v-734f5e7f"]]);export{_e as default};
//# sourceMappingURL=timTPvMD.js.map
