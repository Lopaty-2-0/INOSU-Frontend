import w from"./dFJnGj4t.js";import{u as N,_ as D}from"./CQ3zrzCx.js";import{e as z,z as x,s as T,r as v,j as C,k as S,l as M,w as d,m as R,o as $,a,b as m,u as l,h as Y,v as H,t as y,_ as I}from"./DFLv1YV6.js";import{N as E}from"./gU5XJUlO.js";import{W as U}from"./DAdPMCpP.js";/* empty css        */import{a as b}from"./BUVrFq-o.js";import{m as h}from"./qbsqZPAI.js";import{N as V}from"./BHbpq14p.js";import{u as Z}from"./CJYBnIlQ.js";import{u as B}from"./CZ6KBkoC.js";import"./COvE1TAq.js";import"./DzoiDIvV.js";import"./C2O9fF6a.js";import"./XGKoS8Uj.js";const q={id:"tasks"},F={class:"content"},W={class:"line"},K={class:"line"},L={class:"line"},G={class:"search"},J=["href"],O={class:"actions"},Q=["onClick"],X=z({__name:"available",setup(ee){B({title:"Panel | Dostupné úkoly",meta:[{name:"description",content:"Panel Homepage"}]});const u=x().params.role,f=Z(),e=N(),{getId:g}=T(f),j=v([{field:"id",title:"ID",width:"90px",type:"number"},{field:"name",title:"Název",type:"string"},{field:"startDate",title:"Začátek",type:"date"},{field:"endDate",title:"Konec",type:"date"},{field:"task",title:"Zadání",type:"string"},{field:"actions",title:"Akce"}]),r=v(void 0),_=v(""),k=v(!1),A=async(n,o)=>{if(k.value=!0,o==="classTask"){await b("/user_task/add",{method:"post",body:{idTask:n,idUser:g.value},credentials:"include",ignoreResponseError:!0,headers:{"Content-Type":"application/json"},onResponse({response:s}){var p,t;switch((p=s._data.resCode)==null?void 0:p.toString()){case"36010":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nebyl zadán id úkolu."});break;case"36020":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nebyl zadán id uživatele."});break;case"36030":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Úkol neexistuje."});break;case"36040":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Záznam nebyl vytvořen."});break;case"36051":e.addAlert({type:"success",title:"Přijetí úkolu",message:"Úkol byl úspěšně přijat a čeká na schválení."}),r.value=(t=r.value)==null?void 0:t.filter(c=>c.id!==n);break;default:e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nastala neznámá chyba."});break}},onRequestError(){e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nastala neznámá chyba."})}}).finally(()=>{k.value=!1});return}if(o==="waitingTask"){const s=new FormData;s.append("idTask",n.toString()),s.append("idUser",g.value),s.append("status","pending"),await b("/user_task/update",{method:"put",body:s,credentials:"include",ignoreResponseError:!0,onResponse({response:i}){var t,c;switch((t=i._data.resCode)==null?void 0:t.toString()){case"38010":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nebyl zadán id úkolu."});break;case"38020":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Uživatel neexistuje."});break;case"38030":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Úkol neexistuje."});break;case"38040":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Záznam s uživatelem a úkolem neexistuje."});break;case"38050":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Špatný formát souboru (review)."});break;case"38060":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nelze provést tuto akci (review není povoleno)."});break;case"38070":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Název souboru (review) je příliš dlouhý."});break;case"38080":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Špatný formát souboru (elaboration)."});break;case"38090":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Název souboru (elaboration) je příliš dlouhý."});break;case"38100":e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nedostatečná oprávnění."});break;case"38111":e.addAlert({type:"success",title:"Přijetí úkolu",message:"Úkol byl úspěšně přijat a čeká na schválení."}),r.value=(c=r.value)==null?void 0:c.filter(P=>P.id!==n);break;default:e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nastala neznámá chyba."});break}},onRequestError(){e.addAlert({type:"error",title:"Přijetí úkolu",message:"Nastala neznámá chyba."})}}).finally(()=>{k.value=!1});return}};return C(async()=>{await b("/task/get/possible",{method:"get",credentials:"include",ignoreResponseError:!0,onResponse({response:n}){const o=n._data.data.classTasks.map(i=>({...i,from:"classTask"}))||[],s=n._data.data.waitingTasks.map(i=>({...i,from:"waitingTask"}))||[];r.value=[...o,...s]}})}),(n,o)=>{const s=w,i=D,p=R;return $(),S(p,{name:"panel",loading:!r.value},M({header:d(()=>[m(E,{links:[{name:"Úkoly",path:`/panel/tasks/${l(u)}`},{name:"Dostupné",path:`/panel/tasks/${l(u)}/available`}]},null,8,["links"])]),_:2},[r.value?{name:"content",fn:d(()=>[a("div",q,[a("div",F,[a("div",W,[m(V,{class:"navigation",title:"Úkoly","active-link-id":1,links:[{name:"Aktivní",path:`/panel/tasks/${l(u)}`},{name:"Dostupné",path:`/panel/tasks/${l(u)}/available`},{name:"Stav úkolů",path:`/panel/tasks/${l(u)}/status`},{name:"Vyhodnocené",path:`/panel/tasks/${l(u)}/evaluated`}]},null,8,["links"]),a("div",K,[a("div",L,[o[1]||(o[1]=a("div",{class:"section-head"},[a("h3",null,"Dostupné úkoly"),a("p",null,"Úkoly v této sekci vyžadují potvrzení jejich tvůrcem. Po odeslání žádosti o přijetí úkolu bude vaše žádost nejprve schválena, teprve poté budete moci na úkolu pracovat.")],-1)),a("div",G,[Y(a("input",{type:"text",name:"searchInput",placeholder:"Hledat úkol","onUpdate:modelValue":o[0]||(o[0]=t=>_.value=t)},null,512),[[H,_.value]]),m(s,{class:"icon",name:"material-symbols:search-rounded"})])]),m(l(U),{loading:k.value,rows:r.value,columns:j.value,pageSize:10,sortable:!0,search:_.value},{task:d(t=>[a("a",{href:`http://89.203.248.163/uploads/tasks/${t.value.id}/${t.value.task}`,class:"link",download:"",target:"_blank"},y(t.value.task),9,J)]),startDate:d(t=>[a("p",null,y(l(h)(t.value.startDate).format("DD.MM. YYYY HH:MM")),1)]),endDate:d(t=>[a("p",null,y(l(h)(t.value.endDate).format("DD.MM. YYYY HH:MM")),1)]),approve:d(t=>[a("p",null,y(t.value.approve?"Ano":"Ne"),1)]),actions:d(t=>[a("div",O,[a("button",{type:"button",class:"add",onClick:c=>A(t.value.id,t.value.from)},"Přijmout",8,Q)])]),_:1},8,["loading","rows","columns","search"])])])])]),m(i)]),key:"0"}:void 0]),1032,["loading"])}}}),_e=I(X,[["__scopeId","data-v-c6fc159b"]]);export{_e as default};
//# sourceMappingURL=CkSZGcpn.js.map
