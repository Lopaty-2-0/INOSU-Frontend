{"version":3,"file":"XK7ivTUH.js","sources":["../../../../pages/password/forget/new.vue"],"sourcesContent":["<script lang=\"ts\" setup>\nimport Loading from \"~/components/basics/Loading.vue\";\nimport apiFetch from \"../../../componsables/apiFetch\";\nimport { ref } from \"vue\";\n\nuseHead({\n  title: \"Panel | Zapomenuté heslo\",\n  meta: [{ name: \"description\", content: \"Zapomenuté heslo\" }],\n});\n\nconst messages = ref<{\n  email: string | null;\n  form: { message: string | null; type: \"error\" | \"success\" | null };\n}>({ email: null, form: { message: null, type: null } });\nconst email = ref<string>(\"\");\nconst loading = ref<boolean>(false);\nconst emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n\n//check user inputs\nconst validateForm = (): void => {\n  resetMessages();\n\n  if (!emailRegex.test(email.value))\n    messages.value.email = \"Špatný formát e-mailu\";\n  if (!email.value) messages.value.email = \"Zadejte váš e-mail\";\n};\n\n//reset messages when user start typing\nconst resetMessages = (): void => {\n  messages.value = { email: null, form: { message: null, type: null } };\n};\n\n//check user inputs and send request to API\nconst submitForm = async (): Promise<void> => {\n  validateForm();\n\n  if (messages.value.email) return;\n\n  loading.value = true;\n\n  await apiFetch(\"/user/password/new\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: {\n      email: email.value,\n    },\n    ignoreResponseError: true,\n    credentials: \"include\",\n    async onResponse({ response }) {\n      const resCode: string = response._data.resCode.toString();\n\n      switch (resCode) {\n        case \"12010\":\n          messages.value.form = {\n            type: \"error\",\n            message: \"E-mail nebyl zadán\",\n          };\n          break;\n        case \"12020\":\n          messages.value.form = {\n            type: \"error\",\n            message: \"Špatný formát e-mailu\",\n          };\n          break;\n        case \"12030\":\n          messages.value.form = {\n            type: \"error\",\n            message: \"Tento e-mail nebyl nalezen\",\n          };\n          break;\n        case \"12041\":\n          messages.value.form = {\n            message: \"E-mail byl odeslán\",\n            type: \"success\",\n          };\n          break;\n        default:\n          messages.value.form = {\n            type: \"error\",\n            message: \"Nastala neznámá chyba\",\n          };\n          break;\n      }\n    },\n    async onRequestError() {\n      messages.value.form = { message: \"Nastala neznámá chyba\", type: \"error\" };\n    },\n  });\n\n  loading.value = false;\n};\n</script>\n\n<template>\n  <div id=\"forgetPassword-new\">\n    <div class=\"container\">\n      <div class=\"head\">\n        <h2>Zapomenuté heslo</h2>\n        <p>Zadejte e-mail pro zaslání odkazu pro resetování.</p>\n      </div>\n\n      <form @submit.prevent=\"submitForm\" @input=\"resetMessages\">\n        <div class=\"section\">\n          <label for=\"email\">E-mail</label>\n          <input\n            type=\"text\"\n            id=\"email\"\n            name=\"email\"\n            placeholder=\"test@test.com\"\n            v-model=\"email\"\n          />\n          <p v-if=\"messages.email\" class=\"error\">{{ messages.email }}</p>\n        </div>\n\n        <div class=\"footer\">\n          <button type=\"submit\">Zaslat e-mail</button>\n          <p\n            v-if=\"messages.form.message\"\n            :class=\"{\n              error: messages.form.type === 'error',\n              success: messages.form.type === 'success',\n            }\"\n          >\n            {{ messages.form.message }}\n          </p>\n        </div>\n\n        <div v-if=\"loading\" class=\"loading\">\n          <Loading color=\"rgba(var(--description-color), 1)\" size=\"6px\" />\n        </div>\n\n        <a href=\"/\">Vzpomněli jste si?</a>\n      </form>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n#forgetPassword-new {\n  width: 100%;\n  min-height: 400px;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n\n  .container {\n    max-width: 500px;\n    padding: 20px;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    gap: 30px;\n\n    .head {\n      display: flex;\n      flex-direction: column;\n      gap: 10px;\n      justify-content: center;\n      align-items: center;\n      text-align: center;\n\n      h2 {\n        font-weight: 900;\n        font-size: 36px;\n        color: var(--title-color);\n      }\n\n      p {\n        color: rgba(var(--description-color), 1);\n        font-size: 16px;\n      }\n    }\n\n    form {\n      display: flex;\n      flex-direction: column;\n      gap: 30px;\n      border: var(--border-width) solid rgba(var(--border-color), 0.5);\n      border-radius: var(--medium-border-radius);\n      padding: 30px;\n\n      label {\n        color: var(--mini-title-color);\n        font-size: 16px;\n        font-weight: 500;\n        cursor: pointer;\n      }\n\n      .loading {\n        display: flex;\n        justify-content: center;\n      }\n\n      .error {\n        font-size: 16px;\n        color: rgba(var(--error-color), 1);\n      }\n\n      .success {\n        font-size: 16px;\n        color: rgba(var(--success-color), 1);\n      }\n\n      .section {\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n\n        input {\n          border-radius: var(--normal-border-radius);\n          border: var(--border-width) solid rgba(var(--border-color), 0.5);\n          padding: 15px;\n          font-size: 16px;\n          outline: none;\n          background: var(--input-background);\n          color: var(--input-color);\n\n          &::placeholder {\n            color: var(--input-placeholder-color);\n          }\n\n          &:focus {\n            border-color: rgba(var(--main-color), 1);\n          }\n        }\n      }\n\n      .custom-item {\n        display: flex;\n        flex-direction: row;\n        gap: 10px;\n        align-items: center;\n\n        input[type=\"checkbox\"] {\n          accent-color: rgba(var(--main-color), 1);\n          height: 15px;\n          width: 15px;\n          border-radius: var(--mini-border-radius);\n          cursor: pointer;\n        }\n      }\n\n      .footer {\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n\n        button {\n          padding: 15px;\n          border-radius: var(--normal-border-radius);\n          background: var(--btn-1-background);\n          color: var(--btn-1-color);\n          transition: 0.2s;\n          font-weight: var(--btn-1-font-weight);\n          font-size: 16px;\n          width: 100%;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          gap: 15px;\n\n          &:hover {\n            background: var(--btn-1-hover-background);\n          }\n        }\n      }\n\n      a {\n        color: rgba(var(--description-color), 1);\n        font-size: 16px;\n        transition: 0.2s;\n        width: fit-content;\n\n        &:hover {\n          color: var(--mini-title-color);\n        }\n      }\n    }\n  }\n}\n</style>\n"],"names":["useHead","messages","ref","email","loading","emailRegex","validateForm","resetMessages","submitForm","apiFetch","response"],"mappings":"wYAKQA,EAAA,CACN,MAAO,2BACP,KAAM,CAAC,CAAE,KAAM,cAAe,QAAS,kBAAoB,CAAA,CAAA,CAC5D,EAED,MAAMC,EAAWC,EAGd,CAAE,MAAO,KAAM,KAAM,CAAE,QAAS,KAAM,KAAM,IAAK,CAAA,CAAG,EACjDC,EAAQD,EAAY,EAAE,EACtBE,EAAUF,EAAa,EAAK,EAC5BG,EAAa,mDAGbC,EAAe,IAAY,CACjBC,EAAA,EAETF,EAAW,KAAKF,EAAM,KAAK,IAC9BF,EAAS,MAAM,MAAQ,yBACpBE,EAAM,QAAOF,EAAS,MAAM,MAAQ,qBAC3C,EAGMM,EAAgB,IAAY,CACvBN,EAAA,MAAQ,CAAE,MAAO,KAAM,KAAM,CAAE,QAAS,KAAM,KAAM,KAAO,CACtE,EAGMO,EAAa,SAA2B,CAC/BF,EAAA,EAET,CAAAL,EAAS,MAAM,QAEnBG,EAAQ,MAAQ,GAEhB,MAAMK,EAAS,qBAAsB,CACnC,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,CACJ,MAAON,EAAM,KACf,EACA,oBAAqB,GACrB,YAAa,UACb,MAAM,WAAW,CAAE,SAAAO,GAAY,CAG7B,OAFwBA,EAAS,MAAM,QAAQ,SAAS,EAEvC,CACf,IAAK,QACHT,EAAS,MAAM,KAAO,CACpB,KAAM,QACN,QAAS,oBACX,EACA,MACF,IAAK,QACHA,EAAS,MAAM,KAAO,CACpB,KAAM,QACN,QAAS,uBACX,EACA,MACF,IAAK,QACHA,EAAS,MAAM,KAAO,CACpB,KAAM,QACN,QAAS,4BACX,EACA,MACF,IAAK,QACHA,EAAS,MAAM,KAAO,CACpB,QAAS,qBACT,KAAM,SACR,EACA,MACF,QACEA,EAAS,MAAM,KAAO,CACpB,KAAM,QACN,QAAS,uBACX,EACA,KAAA,CAEN,EACA,MAAM,gBAAiB,CACrBA,EAAS,MAAM,KAAO,CAAE,QAAS,wBAAyB,KAAM,OAAQ,CAAA,CAC1E,CACD,EAEDG,EAAQ,MAAQ,GAClB"}