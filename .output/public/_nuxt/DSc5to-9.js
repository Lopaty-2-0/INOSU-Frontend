import{e as Z,z as F,r as d,j as D,k as P,w as n,m as S,E as B,o as h,a as t,b as r,d as u,h as v,q as p,c as I,u as m,_ as L}from"./CUZeRvXC.js";import{E as V}from"./CYogHZGX.js";import{u as H,_ as q}from"./Z5wW8-57.js";import{N as J}from"./DCknVipl.js";import{a as b}from"./CkL4TXxs.js";import{E as O,a as $,b as M,c as G}from"./ykBKbdeq.js";import{E as K}from"./BTtst_31.js";import{E as Q}from"./ckAZWzE1.js";import{E as W}from"./BXHzklLP.js";import{u as X}from"./Db-zqWpw.js";import"./DaNuMFcU.js";import"./D0YqDxnM.js";import"./BggygjHh.js";import"./CnmWWN_2.js";import"./Bz2aGY34.js";import"./DU8lQhTt.js";const Y={id:"settings"},ee={class:"content"},ae={class:"line page-section no-border"},te={class:"section-head"},se={class:"update"},oe={class:"line page-section"},le={class:"line page-section"},ie={class:"section-head"},re={class:"update"},ne={class:"line page-section"},ue={class:"section-head"},de={class:"update"},ve={class:"line page-section"},pe={class:"section-head"},me={class:"update"},ce={class:"line page-section"},fe={class:"section-head"},be={class:"update"},ke={class:"line page-section"},_e={class:"section-head"},ge={class:"update"},he={key:1,class:"error"},ye=Z({__name:"[id]",setup(je){const y=F(),E=B(),c=y.params.id,f=y.params.role;X({title:"Panel | Upravení uživatele - "+c,meta:[{name:"description",content:"Panel Settings User Information"}]});const l=H(),k=d(!1),i=d(!1),_=d(void 0),g=d(void 0),o=d({loaded:!1,profilePicture:"",name:"",surname:"",email:"",password:"",abbreviation:"",role:"",classes:[]}),e=d({profilePicture:void 0,name:void 0,surname:void 0,email:void 0,password:void 0,abbreviation:void 0,role:void 0,classes:void 0}),z=s=>{e.value.name=s.name,e.value.surname=s.surname},w=s=>{e.value.email=s.email},R=s=>{e.value.password=s.password},A=s=>{e.value.abbreviation=s.abbreviation},C=s=>{e.value.role=s.role},N=s=>{e.value.classes=s.classes},x=s=>{e.value.profilePicture=s.profilePicture},j=()=>{e.value={profilePicture:void 0,name:void 0,surname:void 0,email:void 0,password:void 0,abbreviation:void 0,role:void 0,classes:void 0},i.value=!0,setTimeout(()=>{i.value=!1},100)},T=async()=>{k.value=!0;const s=new FormData;e.value.profilePicture&&s.append("profilePicture",e.value.profilePicture),e.value.name&&s.append("name",e.value.name),e.value.surname&&s.append("surname",e.value.surname),e.value.email&&s.append("email",e.value.email),e.value.abbreviation&&s.append("abbreviation",e.value.abbreviation),e.value.role&&s.append("role",e.value.role),e.value.classes&&s.append("idClass",JSON.stringify(e.value.classes)),s.append("idUser",c),await b("/user/update",{method:"PUT",body:s,credentials:"include",ignoreResponseError:!0,async onResponse({response:a}){switch(a._data.resCode.toString()){case"2040":l.addAlert({type:"error",title:"Úprava uživatele",message:"Nemáte oprávnění k této akci."});break;case"2050":l.addAlert({type:"warning",title:"Úprava uživatele",message:"Nic nebylo zadáno ke změně."});break;case"2060":l.addAlert({type:"error",title:"Úprava uživatele",message:"Špatné ID uživatele."});break;case"2070":l.addAlert({type:"error",title:"Úprava uživatele",message:"Zkratka je již používána."});break;case"2080":l.addAlert({type:"error",title:"Úprava uživatele",message:"Zkratka je příliš dlouhá."});break;case"2090":l.addAlert({type:"error",title:"Úprava uživatele",message:"Špatný formát e-mailu."});break;case"2100":l.addAlert({type:"error",title:"Úprava uživatele",message:"E-mail je již používán."});break;case"2110":l.addAlert({type:"error",title:"Úprava uživatele",message:"E-mail je příliš dlouhý."});break;case"2120":l.addAlert({type:"error",title:"Úprava uživatele",message:"Špatný formát souboru."});break;case"2131":l.addAlert({type:"success",title:"Úprava uživatele",message:"Uživatel byl úspěšně upraven."}),e.value.name&&(o.value.name=e.value.name),e.value.surname&&(o.value.surname=e.value.surname),e.value.email&&(o.value.email=e.value.email),e.value.abbreviation&&(o.value.abbreviation=e.value.abbreviation),e.value.role&&(o.value.role=e.value.role),e.value.classes&&(o.value.classes=e.value.classes),e.value.profilePicture&&(o.value.profilePicture=URL.createObjectURL(e.value.profilePicture)),j();break;default:l.addAlert({type:"error",title:"Úprava uživatele",message:"Nastala neznámá chyba."});break}},async onRequestError(){l.addAlert({type:"error",title:"Úprava uživatele",message:"Nastala neznámá chyba."})}}).finally(()=>{k.value=!1})};return D(async()=>{await b("/user/get/roles",{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,onResponse({response:s}){const a=s._data.data.roles;_.value=a||[]}}),await b("/class/get",{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,onResponse({response:s}){const a=s._data.data.classes;g.value=a||[]}}),await b(`/user/get/id?id=${encodeURIComponent(c)}`,{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,async onResponse({response:s}){const a=s._data.data.user;if(a)o.value.name=a.name,o.value.surname=a.surname,o.value.email=a.email,o.value.password="",o.value.abbreviation=a.abbreviation||"",o.value.role=a.role,o.value.classes=a.idClass,o.value.profilePicture="http://89.203.248.163/uploads/profilePictures/"+a.profilePicture;else{await E.push(`/panel/users/${f}/edit`);return}o.value.loaded=!0}})}),(s,a)=>{const U=S;return h(),P(U,{name:"panel",loading:!_.value||!g.value||!o.value.loaded},{header:n(()=>[r(J,{links:[{name:"Uživatelé",path:"/panel/users"},{name:m(f),path:"/panel/users/"+m(f)},{name:"Upravení",path:"/panel/users/"+m(f)+"/edit"},{name:m(c),path:"/panel/users/"+m(f)+"/edit/"+m(c)}]},null,8,["links"])]),content:n(()=>[t("div",Y,[t("div",ee,[t("div",ae,[r(W,{class:"page-section","old-profile-picture":o.value.profilePicture,onUpdate:x,reset:i.value},{default:n(()=>[t("div",te,[t("h3",null,[a[0]||(a[0]=u(" Profilová fotka ")),v(t("span",se,"(aktualizováno)",512),[[p,e.value.profilePicture]])]),a[1]||(a[1]=t("p",null,"Zde můžete změnit profilovou fotku uživatele. Nahrajte novou fotku, pokud si přejete aktualizovat stávající obrázek.",-1))])]),_:1},8,["old-profile-picture","reset"])]),t("div",oe,[r(O,{"old-full-name":{name:o.value.name,surname:o.value.surname},reset:i.value,onUpdate:z},{default:n(()=>a[2]||(a[2]=[t("div",{class:"section-head"},[t("h3",null,"Jméno a příjmení"),t("p",null,"Zadejte nové jméno a příjmení uživatele, pokud je chcete změnit.")],-1)])),_:1},8,["old-full-name","reset"])]),t("div",le,[r($,{"old-email":o.value.email,reset:i.value,onUpdate:w},{default:n(()=>[t("div",ie,[t("h3",null,[a[3]||(a[3]=u("E-mail ")),v(t("span",re,"(aktualizováno)",512),[[p,e.value.email]])]),a[4]||(a[4]=t("p",null,"Zadejte novou e-mailovou adresu uživatele, pokud ji chcete změnit.",-1))])]),_:1},8,["old-email","reset"])]),t("div",ne,[r(K,{type:"new",reset:i.value,onUpdate:R},{default:n(()=>[t("div",ue,[t("h3",null,[a[5]||(a[5]=u("Heslo k účtu ")),v(t("span",de,"(aktualizováno)",512),[[p,e.value.password]])]),a[6]||(a[6]=t("p",null,"Zadejte nové heslo, pokud chcete uživateli změnit přístupové údaje. Heslo musí splňovat bezpečnostní požadavky.",-1))])]),_:1},8,["reset"])]),t("div",ve,[r(M,{roles:_.value||[],"old-role":o.value.role,reset:i.value,onUpdate:C},{default:n(()=>[t("div",pe,[t("h3",null,[a[7]||(a[7]=u("Role ")),v(t("span",me,"(aktualizováno)",512),[[p,e.value.role]])]),a[8]||(a[8]=t("p",null,"Zvolte roli, kterou má uživatel mít. Role určuje oprávnění a možnosti uživatele v systému.",-1))])]),_:1},8,["roles","old-role","reset"])]),t("div",ce,[r(G,{"full-name":{name:e.value.name?e.value.name:o.value.name,surname:e.value.surname?e.value.surname:o.value.surname},"old-abbreviation":o.value.abbreviation,reset:i.value,onUpdate:A},{default:n(()=>[t("div",fe,[t("h3",null,[a[9]||(a[9]=u("Přezdívka ")),v(t("span",be,"(aktualizováno)",512),[[p,e.value.abbreviation]])]),a[10]||(a[10]=t("p",null,"Zadejte novou přezdívku uživatele, pokud ji chcete změnit. Přezdívka slouží jako zkratka jména například pro rychlou identifikaci.",-1))])]),_:1},8,["full-name","old-abbreviation","reset"])]),t("div",ke,[t("div",_e,[t("h3",null,[a[11]||(a[11]=u("Třída ")),v(t("span",ge,"(aktualizováno)",512),[[p,e.value.classes]])]),a[12]||(a[12]=t("p",null,"Vyberte třídu nebo více tříd, které chcete uživateli přiřadit.",-1))]),(e.value.role?e.value.role==="student":o.value.role==="student")?(h(),P(Q,{key:0,"old-class-ids":o.value.classes,classes:g.value||[],reset:i.value,onUpdate:N},null,8,["old-class-ids","classes","reset"])):(h(),I("p",he,a[13]||(a[13]=[u(" Třídy můžete vybírat pouze pokud role uživatele je "),t("strong",null,"student",-1),u(". ")])))]),r(V,{"is-loading":k.value,"reset-function":j,"submit-function":T},null,8,["is-loading"])]),r(q)])]),_:1},8,["loading"])}}}),Ie=L(ye,[["__scopeId","data-v-f8966587"]]);export{Ie as default};
//# sourceMappingURL=DSc5to-9.js.map
