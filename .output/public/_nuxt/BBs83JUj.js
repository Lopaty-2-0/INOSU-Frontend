import x from"./BOQHfSiJ.js";import{e as C,r,j as w,k as S,l as z,w as c,m as I,o as N,a as e,b as d,t as l,h as g,v as T,d as O,q as A,u as R,_ as j}from"./qt0h0kFv.js";import{N as B}from"./2dFQOzvg.js";import{u as V,_ as $}from"./fzoHn8T8.js";import{W as D}from"./ByFXw8iZ.js";/* empty css        */import{A as E}from"./ndivdKBF.js";import{a as h}from"./CI6GBMjg.js";import{L as H}from"./CI2UeAAB.js";import{u as L}from"./KD0uSQAu.js";import"./DgTH69TZ.js";import"./DjacMGf3.js";import"./DZFHCepi.js";import"./DlhrDTwY.js";const P={id:"classes"},q={class:"content"},M={class:"line"},W={class:"section-head"},Z={class:"search"},F={class:"buttons"},U=C({__name:"remove",setup(G){L({title:"Panel | Třídy - Odstranění",meta:[{name:"description",content:"Panel Homepage"}]});const n=V(),f=r([{field:"id",title:"ID",width:"90px",type:"number"},{field:"name",title:"Název",type:"string"},{field:"class",title:"Třída",type:"string"},{field:"grade",title:"Ročník",type:"number"},{field:"group",title:"Skupina",type:"string"},{field:"specialization",title:"Zaměření",type:"string"}]),u=r(null),o=r(void 0),i=r([]),m=r(!1),v=r(""),_=()=>{u.value.clearSelectedRows(),i.value=[]},b=()=>{u.value&&setTimeout(()=>{i.value=u.value.getSelectedRows()},0)},k=async()=>{m.value=!0,await h("/class/delete",{method:"delete",headers:{"Content-Type":"application/json"},body:{idClass:i.value.map(t=>t.id)},ignoreResponseError:!0,credentials:"include",onResponse({response:t}){var p;switch(t._data.resCode.toString()){case"9010":n.addAlert({type:"error",title:"Odstranění tříd",message:"Nedostatečné oprávnění pro odstranění tříd."});break;case"9020":n.addAlert({type:"warning",title:"Odstranění tříd",message:"Žádná třída nebyla vybrána."});break;case"9031":(t._data.data.taskIds||[]).length>=1?n.addAlert({type:"warning",title:"Odstranění tříd",message:`Některé třídy nebyly odstraněny. Tyto úkoly používají některé z odstraňovaných tříd: ${t._data.data.taskIds.join(", ")}`}):(t._data.data.userIds||[]).length>=1?n.addAlert({type:"warning",title:"Odstranění tříd",message:`Některé třídy nebyly odstraněny. Tito uživatelé používají některé z odstraňovaných tříd: ${t._data.data.userIds.join(", ")}`}):n.addAlert({type:"success",title:"Odstranění tříd",message:`Třídy byly úspěšně odstraněny. (${t._data.data.goodIds.length}/${i.value.length})`}),o.value=(p=o.value)==null?void 0:p.filter(y=>!t._data.data.goodIds.includes(y.id)),_();break;default:n.addAlert({type:"error",title:"Odstranění tříd",message:"Nastala neznámá chyba."});break}},onRequestError(){n.addAlert({type:"error",title:"Odstranění tříd",message:"Nastala neznámá chyba."})}}).finally(()=>{m.value=!1})};return w(async()=>{await h("/class/get",{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,onResponse({response:t}){const a=t._data.data.classes;o.value=a||[]}})}),(t,a)=>{const p=x,y=I;return N(),S(y,{name:"panel",loading:!o.value},z({header:c(()=>[d(B,{links:[{name:"Třídy",path:"/panel/classes"},{name:"Odstranění",path:"/panel/classes/remove"}]})]),_:2},[o.value?{name:"content",fn:c(()=>[e("div",P,[e("div",q,[d(E,{class:"action-bar",description:"Správa tříd",texts:["Přidat","Odebrat"],actions:["add","remove"],icons:["material-symbols:add-rounded","material-symbols:delete-rounded"],active:1,"navigate-to":["/panel/classes/add","/panel/classes/remove"]}),e("div",M,[e("div",W,[e("h3",null,"Třídy: "+l(i.value.length)+" / "+l(o.value.length),1),a[1]||(a[1]=e("p",null,"Vyberte třídy, které chcete trvale odstranit ze systému.",-1))]),e("div",Z,[g(e("input",{type:"text",name:"searchInput",placeholder:"Hledat třídy","onUpdate:modelValue":a[0]||(a[0]=s=>v.value=s)},null,512),[[T,v.value]]),d(p,{class:"icon",name:"material-symbols:search-rounded"})])]),e("div",F,[e("button",{class:"remove",onClick:k},[a[2]||(a[2]=O(" Odstranit ")),g(d(H,{size:"5px",color:"var(--actionBar-actions-remove-color)"},null,512),[[A,m.value]])]),e("button",{class:"reset",onClick:_}," Zrušit vše ")]),d(R(D),{ref_key:"datatable",ref:u,rows:o.value,columns:f.value,hasCheckbox:!0,pageSize:10,sortable:!0,search:v.value,onInput:b},{group:c(s=>[e("p",null,l(s.value.group),1)]),specialization:c(s=>[e("p",null,l(s.value.specialization),1)]),class:c(s=>[e("p",null,l(s.value.specialization)+l(s.value.grade)+l(s.value.group),1)]),_:1},8,["rows","columns","search"])])]),d($)]),key:"0"}:void 0]),1032,["loading"])}}}),ie=j(U,[["__scopeId","data-v-8adfaf42"]]);export{ie as default};
//# sourceMappingURL=BBs83JUj.js.map
