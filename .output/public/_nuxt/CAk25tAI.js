import x from"./B02K3sSP.js";import{u as H,_ as P}from"./Dp9DwRaU.js";import{e as D,z as j,r as k,j as C,k as R,l as S,w as _,m as $,E as I,o as M,a as e,b as u,u as c,t as n,d as T,h as E,v as U,_ as Y}from"./kDuM05C4.js";import{N as V}from"./D4lJweNB.js";import{W as Z}from"./q8yB3ppu.js";/* empty css        */import{A as B}from"./BXO4Rf_k.js";import{a as h}from"./CqzinUfa.js";import{m as g}from"./qbsqZPAI.js";import{N as F}from"./BRAkY3Bx.js";import{u as q}from"./1qNVQyrd.js";import"./Fcahhvwm.js";import"./gZJpIgEh.js";import"./D_aNzk6r.js";import"./DKN3VG1g.js";import"./Dy3G499-.js";const O={id:"tasks"},W={class:"content"},G={class:"line"},J={class:"line"},K={class:"line"},L={class:"section-head"},Q={class:"section-head"},X=["href"],ee={class:"search"},te={class:"profile"},ae=["src"],oe={class:"uppercase"},se={class:"actions"},re=["onClick"],ne=["onClick"],le=D({__name:"index",setup(ie){const f=j(),z=I(),l=f.params.taskId;q({title:"Panel | Žádosti o úkol - "+l,meta:[{name:"description",content:"Panel Homepage"}]});const t=H(),s=k(void 0),p=k(!1),A=k([{field:"id",title:"ID",width:"90px",type:"number"},{field:"name",title:"Žadatel",type:"string"},{field:"abbreviation",title:"Zkratka",type:"date"},{field:"email",title:"E-mail",type:"string"},{field:"actions",title:"Akce"}]),i=k(void 0),b=k(""),N=async r=>{p.value=!0;const a=new FormData;a.append("idTask",l),a.append("idUser",r.toString()),a.append("status","approved"),await h("/user_task/update",{method:"put",body:a,credentials:"include",ignoreResponseError:!0,onResponse({response:m}){var d,o;switch((d=m._data.resCode)==null?void 0:d.toString()){case"38010":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Nebyl zadán id úkolu."});break;case"38020":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Uživatel neexistuje."});break;case"38030":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Úkol neexistuje."});break;case"38040":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Záznam s uživatelem a úkolem neexistuje."});break;case"38050":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Špatný formát souboru (review)."});break;case"38060":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Nelze provést tuto akci (review lze nahrát jen u schváleného úkolu)."});break;case"38070":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Název souboru (review) je příliš dlouhý."});break;case"38100":t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Nemáte oprávnění."});break;case"38111":t.addAlert({type:"success",title:"Potvrzení úkolu",message:"Úkol byl úspěšně potvrzen."}),i.value=(o=i.value)==null?void 0:o.filter(v=>Number(v.id)!==r);break;default:t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Nastala neznámá chyba."});break}},onRequestError(){t.addAlert({type:"error",title:"Potvrzení úkolu",message:"Nastala neznámá chyba při odesílání požadavku."})}}).finally(()=>{p.value=!1})},w=async r=>{p.value=!0;const a=new FormData;a.append("idTask",l),a.append("idUser",r.toString()),a.append("status","rejected"),await h("/user_task/update",{method:"put",body:a,credentials:"include",ignoreResponseError:!0,onResponse({response:m}){var d,o;switch((d=m._data.resCode)==null?void 0:d.toString()){case"38010":t.addAlert({type:"error",title:"Hodnocení",message:"Nebyl zadán id úkolu."});break;case"38020":t.addAlert({type:"error",title:"Hodnocení",message:"Uživatel neexistuje."});break;case"38030":t.addAlert({type:"error",title:"Hodnocení",message:"Úkol neexistuje."});break;case"38040":t.addAlert({type:"error",title:"Hodnocení",message:"Záznam user_task neexistuje."});break;case"38050":t.addAlert({type:"error",title:"Hodnocení",message:"Špatný formát souboru (review)."});break;case"38060":t.addAlert({type:"error",title:"Hodnocení",message:"Nelze provést tuto akci (review lze nahrát jen u schváleného úkolu)."});break;case"38070":t.addAlert({type:"error",title:"Hodnocení",message:"Název souboru (review) je příliš dlouhý."});break;case"38080":t.addAlert({type:"error",title:"Vypracování",message:"Špatný formát souboru (elaboration)."});break;case"38090":t.addAlert({type:"error",title:"Vypracování",message:"Název souboru (elaboration) je příliš dlouhý."});break;case"38100":t.addAlert({type:"error",title:"Hodnocení",message:"Nemáte oprávnění."});break;case"38111":t.addAlert({type:"success",title:"Hodnocení",message:"Hodnocení bylo úspěšně aktualizováno."}),i.value=(o=i.value)==null?void 0:o.filter(v=>Number(v.id)!==r);break;default:t.addAlert({type:"error",title:"Hodnocení",message:"Nastala neznámá chyba."});break}},onRequestError(){t.addAlert({type:"error",title:"Zamítnutí úkolu",message:"Nastala neznámá chyba při odesílání požadavku."})}}).finally(()=>{p.value=!1})};return C(async()=>{await h(`/task/get/id?idTask=${l}`,{method:"get",headers:{"Content-Type":"application/json"},credentials:"include",ignoreResponseError:!0,async onResponse({response:r}){const a=r._data.data.task;if(!a){await z.push("/panel/tasks/teacher");return}s.value=a}}),await h(`/user_task/get/status/idTask?idTask=${l}&status=${encodeURIComponent(JSON.stringify(["pending"]))}`,{method:"get",credentials:"include",ignoreResponseError:!0,onResponse({response:r}){i.value=(r._data.data.tasks||[]).map(a=>a.elaborator)||[]}})}),(r,a)=>{const m=x,y=P,d=$;return M(),R(d,{name:"panel",loading:!i.value||!s.value},S({header:_(()=>[u(V,{links:[{name:"Úkoly",path:"/panel/tasks/teacher"},{name:"Žádosti",path:`/panel/tasks/teacher/${c(l)}`}]},null,8,["links"])]),_:2},[i.value&&s.value?{name:"content",fn:_(()=>[e("div",O,[e("div",W,[u(B,{class:"action-bar",description:"Správa úkolů",texts:["Přidat","Odebrat"],actions:["add","remove"],icons:["material-symbols:add-rounded","material-symbols:delete-rounded"],"navigate-to":["/panel/tasks/teacher/add","/panel/tasks/teacher/remove"]}),e("div",G,[u(F,{class:"navigation",title:"Úkoly","active-link-id":0,links:[{name:"Žádosti",path:`/panel/tasks/teacher/${c(l)}`},{name:"Rozpracované",path:`/panel/tasks/teacher/${c(l)}/inProgress`},{name:"Vypracované",path:`/panel/tasks/teacher/${c(l)}/done`}]},null,8,["links"]),e("div",J,[e("div",K,[e("div",L,[e("div",Q,[a[2]||(a[2]=e("h3",null,"Žádosti o úkol",-1)),e("p",null,"Úkol ID: "+n(s.value.id),1),e("p",null,"Název: "+n(s.value.name),1),e("p",null,"Garant ID: "+n(s.value.guarantor),1),e("p",null,"Začátek: "+n(c(g)(s.value.startDate).format("DD.MM. YYYY HH:MM")),1),e("p",null,"Konec: "+n(c(g)(s.value.endDate).format("DD.MM. YYYY HH:MM")),1),e("p",null,"Nutné potvrzení: "+n(s.value.approve?"Ano":"Ne"),1),e("p",null,[a[1]||(a[1]=T(" Zadání: ")),e("a",{href:`http://89.203.248.163/uploads/tasks/${s.value.id}/${s.value.task}`,class:"link",download:"",target:"_blank"},n(s.value.task),9,X)])])]),e("div",ee,[E(e("input",{type:"text",name:"searchInput",placeholder:"Hledat uživatele","onUpdate:modelValue":a[0]||(a[0]=o=>b.value=o)},null,512),[[U,b.value]]),u(m,{class:"icon",name:"material-symbols:search-rounded"})])]),u(c(Z),{loading:p.value,rows:i.value,columns:A.value,pageSize:10,sortable:!0,search:b.value},{name:_(o=>[e("div",te,[e("img",{src:"http://89.203.248.163/uploads/profilePictures/"+o.value.profilePicture,alt:"User profile photo",loading:"lazy"},null,8,ae),e("p",null,n(o.value.name)+" "+n(o.value.surname),1)])]),abbreviation:_(o=>[e("p",oe,n(o.value.abbreviation||"Není"),1)]),actions:_(o=>[e("div",se,[e("button",{type:"button",class:"accept",onClick:v=>N(o.value.id)},"Přijmout",8,re),e("button",{type:"button",class:"deny",onClick:v=>w(o.value.id)},"Zamítnout",8,ne)])]),_:1},8,["loading","rows","columns","search"])])])])]),u(y)]),key:"0"}:void 0]),1032,["loading"])}}}),we=Y(le,[["__scopeId","data-v-14444f08"]]);export{we as default};
//# sourceMappingURL=CAk25tAI.js.map
